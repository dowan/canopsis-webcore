Ember.Application.initializer({name:"component-actionbutton",after:"ActionsUtils",initialize:function(e,t){var i=e.lookupFactory("utility:actions"),n=Ember.Component.extend({action:void 0,actions:{doAction:function(e,t){i.doAction(e,t)}}});t.register("component:component-actionbutton",n)}}),Ember.Application.initializer({name:"component-actionfilter",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({init:function(){this._super(),this.set("selectedAction","pass"),console.log(" ! --- > content",this.get("content")),void 0===i(this,"content")?n(this,"contentUnprepared",Ember.A()):n(this,"contentUnprepared",i(this,"content"))},selectedAction:"pass",availableactions:["pass","drop","override","remove","execjob"],isOverride:function(){return console.log("isOverride",i(this,"selectedAction"),"override"===i(this,"selectedAction")),"override"===i(this,"selectedAction")}.property("selectedAction"),isRoute:function(){return!1}.property("selectedAction"),isRemove:function(){return console.log("isRemove",i(this,"selectedAction"),"remove"===i(this,"selectedAction")),"remove"===i(this,"selectedAction")}.property("selectedAction"),isExecJob:function(){return console.log("isExecJob",i(this,"selectedAction"),"execjob"===i(this,"selectedAction")),"execjob"===i(this,"selectedAction")}.property("selectedAction"),actions:{addAction:function(){var e={type:i(this,"selectedAction")};"override"===i(this,"selectedAction")&&(e.field=i(this,"field"),e.value=i(this,"value")),"remove"===i(this,"selectedAction")&&(e.key=i(this,"key")),"execjob"===i(this,"selectedAction")&&(e.job=i(this,"jobid")),console.log("Adding action",e),i(this,"contentUnprepared").pushObject(e),n(this,"content",i(this,"contentUnprepared"))},deleteAction:function(e){console.log("Removing action",e),i(this,"contentUnprepared").removeObject(e),n(this,"content",i(this,"contentUnprepared"))}}});t.register("component:component-actionfilter",o)}}),Ember.Application.initializer({name:"component-arrayclassifiedcrecordselector",after:"component-classifiedcrecordselector",initialize:function(e,t){var i=e.lookupFactory("component:component-classifiedcrecordselector"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=i.extend({multiselect:!0,setInitialContent:function(e){var t=n(this,"valueKey");if(console.log("setInitialContent",t,typeof e,e),e)if(t)o(this,"loadingInitialContent","true");else for(var i=n(this,"selectionUnprepared"),r=0,s=e.length;s>r;r++)i.pushObject({name:e[r]})},selectionChanged:function(){this._super();var e=n(this,"selection"),t=n(this,"valueKey");r(t)&&(t="name");for(var i={},s=[],a=[],l=0;l<e.length;l++){var c=n(e[l],t);i[c]||(i[c]=1,a.push(c),s.push(e[l]))}o(this,"selection",s),o(this,"content",a)}.observes("selectionUnprepared","selectionUnprepared.@each"),extractItems:function(e){var t=n(this,"valueKey"),i=n(this,"content");if(t){var o=[];console.log("extractItems",arguments);for(var r=0,s=i.length;s>r;r++){var a=e.findBy("id",i);void 0!==a&&o.pushObject({name:a.get(t)})}this.setProperties({selectionUnprepared:o,loadingInitialContent:!1})}}});t.register("component:component-arrayclassifiedcrecordselector",s)}}),Ember.Application.initializer({name:"component-arrayeditor",after:"ValidationFieldMixin",initialize:function(e,t){var i=e.lookupFactory("mixin:validation-field"),n=Ember.get,o=Ember.set,r=Ember.Component.extend(i,{valueRefPath:"content.value",valuePath:"value",init:function(){this._super.apply(this,arguments),o(this,"componentDataStore",DS.Store.create({container:n(this,"container")}));var e=n(this,"content.value")||[];o(this,"value",e),o(this,"content.value",e);var t=n(this,"value"),i=this;Ember.run(function(){if(o(i,"arrayAttributes",Ember.A()),void 0!==t)for(var e=0,r=t.length;r>e;e++)n(i,"arrayAttributes").pushObject(i.generateVirtualAttribute(e))})},itemEditorType:function(){var e=n(this,"content.model.options.items.type"),t=n(this,"content.model.options.items.role");console.log("editorType",n(this,"content"),e,t);var i;return i=t?"editor-"+t:"editor-"+e,void 0===Ember.TEMPLATES[i]&&(i="editor-defaultpropertyeditor"),i}.property("content.model.options.items.type","content.model.options.items.role"),generateVirtualAttribute:function(e){var t=n(this,"value"),i=n(this,"content.model.options.items"),r=this;console.log("generateVirtualAttribute",e,t[e]);var s=Ember.Object.create({parent:r,index:e,value:t[e]});o(s,"model",Ember.Object.create()),o(s,"model.options",Ember.Object.create());for(var a in i)"value"!==a&&Ember.set(s,"model.options."+a,i[a]);return console.log("generateVirtualAttribute virtual attribute",s),Ember.addObserver(s,"value",function(e){console.log("value changed",e.value,e.index),n(r,"value").removeAt(e.index),n(r,"value").insertAt(e.index,e.value),console.log("content changed",r.get("value"))}),console.log("generateVirtualAttribute"),s},contentChanged:function(){console.log("recompute contentAttributeArray")},actions:{move:function(e,t){var i=n(this,"arrayAttributes"),o=i.indexOf(t);"up"===e&&o>0&&(console.log("processing",e),this.moveItem(o,o-1)),"down"===e&&o<n(i,"length")-1&&(console.log("processing",e),this.moveItem(o,o+1))},addItem:function(){console.log("addItem",n(this,"value"));var e=n(this,"value"),t=n(this,"content.model.options.items.type"),i=n(this,"content.model.options.items.model"),o=n(this,"content.model.options.items.objectDict");if(void 0!==i){var r=n(this,"componentDataStore"),s=r.createRecord(i,{xtype:i});e.pushObject(s)}else"object"===t?e.pushObject(Ember.Object.create(o)):e.pushObject(void 0);var a=e.length-1,l=this.generateVirtualAttribute(a);n(this,"arrayAttributes").pushObject(l),this.validate()},removeItem:function(e){console.log("removeItem",n(this,"value"));var t=n(this,"arrayAttributes");n(this,"value").removeAt(e.index),t.removeAt(e.index);for(var i=e.index,o=t.length;o>i;i++)t.objectAt(i).set("index",t.objectAt(i).get("index")-1);this.validate()}},moveItem:function(e,t){console.log("moveItem",arguments);var i=n(this,"arrayAttributes");i.arrayContentWillChange(e,1,0);var o=i[e];i.splice(e,1),i.splice(t,0,o);for(var r=0,s=i.length;s>r;r++)i[r].index=r;i.arrayContentDidChange(t,0,1),i=n(this,"value"),i.arrayContentWillChange(e,1,0),o=i[e],i.splice(e,1),i.splice(t,0,o),i.arrayContentDidChange(t,0,1)}});t.register("component:component-arrayeditor",r)}}),Ember.Application.initializer({name:"component-classifiedcrecordselector",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({model:void 0,modelfilter:void 0,data:void 0,nameKeyDefault:"crecord_name",nameKey:"crecord_name",idKeyDefault:"id",idKey:"id",items:[],selectedValue:void 0,init:function(){this._super(arguments),n(this,"selectionUnprepared",Ember.A()),this.set("store_"+i(this,"elementId"),DS.Store.create({container:this.get("container")}));var e=i(this,"content");console.log("init",e),this.setInitialContent(e),this.refreshContent()},actions:{"do":function(e,t){this.targetObject.send(e,t)}},setInitialContent:function(e){var t=i(this,"valueKey")||i(this,"valueKeyDefault");if(console.log("setInitialContent",t),e&&(t&&n(this,"loadingInitialContent","true"),!t))if("string"==typeof e)n(this,"selectionUnprepared",[{name:e}]);else if("object"==typeof e&&null!==e){var o=[];for(var r in e)if(e.hasOwnProperty(r)){var s=this.deserializeAdditionnalData(i(e,r));s.name=r,o.pushObject(s)}n(this,"selectionUnprepared",o)}else n(this,"selectionUnprepared",[])},classifiedItems:function(){var e=i(this,"items"),t=i(this,"valueKey")||i(this,"valueKeyDefault"),n=i(this,"nameKey")||i(this,"nameKeyDefault");console.log("recompute classifiedItems",i(this,"items"),t);for(var o=Ember.Object.create({all:Ember.A()}),r=0,s=e.length;s>r;r++){var a=e[r],l={name:a.get(n)};t&&(console.log("add valueKey",a.get(t)),l.value=a.get(t),console.log("objDict value",a,a.get(t))),this.serializeAdditionnalData(a,l),o.all.pushObject(Ember.Object.create(l))}return o}.property("items","items.@each"),selectionChanged:function(){console.log("selectionChanged");var e,t=i(this,"selectionUnprepared"),o=i(this,"valueKey");if(i(this,"multiselect"))if(e=Ember.A(),console.log("Push",t[0]),o)for(var r=0,s=t.length;s>r;r++)e.pushObject(t[r]);else for(var a=0,l=t.length;l>a;a++)e.pushObject(t[a]);else Ember.isArray(t)&&(e=o?t[0]:t[0]);n(this,"selection",e)}.observes("selectionUnprepared","selectionUnprepared.@each"),onDataChange:function(){console.error("refreshContent"),this.refreshContent()}.observes("data.@each"),onModelFilterChange:function(){this.set("currentPage",1),this.refreshContent()}.observes("modelfilter"),refreshContent:function(){this._super(arguments),this.findItems(),console.log(this.get("widgetDataMetas"))},findItems:function(){var e=this,t=i(this,"crecordtype"),n=this.get("store_"+i(this,"elementId")),o={start:0,limit:1e4,filter:i(this,"modelfilter")};console.log("findItems",this.get("crecordtype"),o),"view"===t&&(t="userview"),n.findQuery(t,o).then(function(t){e.set("widgetDataMetas",t.meta);var i=t.get("content");e.set("items",i),Ember.run.scheduleOnce("afterRender",{},function(){e.rerender()}),e.extractItems(i)})},extractItems:function(e){var t=i(this,"valueKey"),o=i(this,"idKey")||i(this,"idKeyDefault"),r=i(this,"nameKey")||i(this,"nameKeyDefault"),s=i(this,"content");if(console.log("extractItems",e,s),t){var a;if("string"==typeof s){if(console.log("extractItems with valueKey",arguments,Ember.inspect(s)),a=e.findBy(o,s),console.log("correspondingExtractedItem",a),void 0!==a){var l=[{name:i(a,r),value:i(a,o)}];n(this,"selectionUnprepared",l)}}else if("object"==typeof s&&null!==s){for(var c=[],d=Ember.keys(s),u=0,p=d.length;p>u;u++){var h=d[u];if(s.hasOwnProperty(h)){var m=i(s,h);console.log("findBy",o,h,m),a=e.findBy(o,m);var f={name:i(a,r),value:i(a,o)};c.pushObject(f)}}n(this,"selectionUnprepared",c)}n(this,"loadingInitialContent",!1)}},deserializeAdditionnalData:function(e){console.log("deserializeAdditionnalData",arguments)},serializeAdditionnalData:function(e){console.log("serializeAdditionnalData",arguments)}});t.register("component:component-classifiedcrecordselector",o)}}),Ember.Application.initializer({name:"component-classifieditemselector",initialize:function(e,t){var i=Ember.set,n=Ember.get,o=Ember.isNone,r=Ember.Component.extend({multiselect:!0,showselection:!0,init:function(){this._super.apply(this,arguments),i(this,"allCollapsed",!0),Ember.isArray(n(this,"selection"))||(console.warn("override selection property"),i(this,"selection",Ember.A()))},actions:{setListMode:function(){i(this,"mode","list")},setIconMode:function(){i(this,"mode","icon")},unselectItem:function(e){n(this,"selection").removeObject(e),n(this,"target")&&n(this,"target").send("unselectItem",e.name)},selectItem:function(e){if(console.log("selectItem",arguments),n(this,"multiselect")===!1)i(this,"selection",[e]);else{var t=n(this,"selection").filter(function(t,i,n){return t===e});0===t.length&&n(this,"selection").pushObject(e)}n(this,"target")?n(this,"target").send("selectItem",e.name):console.warn("no target attribute for Classifieditemselector",this)},collapse:function(e){if("all"===e)n(this,"allCollapsed")===!0?i(this,"allCollapsed",!1):i(this,"allCollapsed",!0);else if("selection"===e)n(this,"selectionCollapsed")===!0?i(this,"selectionCollapsed",!1):i(this,"selectionCollapsed",!0);else{var t=n(this,"classes").findBy("key",e.key);console.log("collapse",e,e.key,t),t.isCollapsed===!0||void 0===t.isCollapsed?(i(t,"isCollapsed",!1),i(e,"isCollapsed",!1)):(i(t,"isCollapsed",!0),i(e,"isCollapsed",!0))}}},searchFilter:"",allCollapsed:!1,selectionCollapsed:!1,classesCollapsed:!0,mode:"list",defaultIcon:"unchecked",iconModeButtonCssClass:function(){return"icon"===n(this,"mode")?"btn btn-default active":"btn btn-default"}.property("mode"),listModeButtonCssClass:function(){return"list"===n(this,"mode")?"btn btn-default active":"btn btn-default"}.property("mode"),listGroupClass:function(){return"list-group "+n(this,"mode")}.property("mode"),classAllPanelId:function(){return n(this,"elementId")+"_all"}.property(),classAllPanelHref:function(){return"#"+n(this,"classAllPanelId")}.property(),allClasses:function(){var e=n(this,"searchFilter"),t=n(this,"content.all");if(!o(t)){var i=this;t=n(this,"content.all").filter(function(e,t,n){console.log("filter",e);var r=i.get("content.byClass.system");return!o(r)&&r.filterBy("name",e.get("name")).length>0?(console.log("filtered!",e),!1):!0}),""!==e&&(t=t.filter(function(t,i,n){var o=t.name.slice(0,e.length)==e;return o}))}return console.log("recompute allClasses",t),t}.property("searchFilter"),collapsedPanelCssClass:"list-group collapse",expandedPanelCssClass:"list-group",classList:function(){var e=n(this,"content.byClass");return console.log("contentByClass",e),null!==e&&void 0!==e?$.map(e,function(t,i){return e.hasOwnProperty(i)?i:void 0}):void 0}.property("content"),classesFiltered:function(){for(var e=n(this,"classes"),t=n(this,"searchFilter"),i=Ember.A(),o=function(e,i,n){var o=-1!==e.name.indexOf(t);return o},r=0,s=e.length;s>r;r++){var a=Ember.Object.create({key:e[r].key,items:e[r].items,id:e[r].id,titleHref:e[r].titleHref,isCollapsed:e[r].isCollapsed||n(this,"classesCollapsed")}),l=a.items;console.log("classItems",l),""!==t&&(console.log("filter",l),l=l.filter(o),a.items=l,console.log("filterEnd",l)),i.push(a)}return console.log("classesFiltered CP end"),i}.property("classes","searchFilter"),classes:function(){var e=this,t=n(this,"content.byClass");return console.log("classes CP",arguments,this,t),void 0!==t?$.map(t,function(o,r){if(t.hasOwnProperty(r)){var s=Ember.Object.create({key:r,items:o,id:n(e,"elementId")+"_"+r,titleHref:"#"+n(e,"elementId")+"_"+r}),a=[s];return i(a,"isCollapsed",t[r].isCollapsed),a}}):(i(e,"allCollapsed",!0),[])}.property("content")});t.register("component:component-classifieditemselector",r)}}),Ember.Application.initializer({name:"component-colorchooser",initialize:function(e,t){var i=Ember.Component.extend({});t.register("component:component-colorchooser",i)}}),Ember.Application.initializer({name:"component-colpick",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({classNames:["colorSelector dropdown-toggle"],init:function(){this._super(),n(this,"store",DS.Store.create({container:this.get("container")}))},didInsertElement:function(){var e=this,t={flat:!0,layout:"hex",submit:0,onChange:function(t,i){n(e,"value","#"+i)}};this.get("store").findAll("rangecolor",{}).then(function(t){for(var o=i(t,"content"),r=o.length-1;r>=0;r--)for(var s=i(o[r],"colors"),a=s.length-1;a>=0;a--){var l=s[a],c="background-color:"+l,d=!1,u=l;s[a]={style:c,selected:d,code:u}}n(e,"ranges",o)});var o=i(this,"value");o&&(t.color=o),e.$(".colorGrid").hide(),e.$("#colorPicker").addClass("activeColor"),e.$("#colorPicker").click(function(){e.$(".customcolor").show(),e.$("#colorPicker").addClass("activeColor"),e.$(".colorGrid").hide(),e.$("#colorGrid").removeClass("activeColor")}),e.$("#colorGrid").click(function(){e.$(".customcolor").hide(),e.$("#colorPicker").removeClass("activeColor"),e.$(".colorGrid").show(),e.$("#colorGrid").addClass("activeColor")}),e.$(".customcolor").colpick(t),this._super()},actions:{changeColor:function(e,t){for(var o=this,r=e,s=r.code,a=t.length-1;a>=0;a--)for(var l=i(t[a],"colors"),c=l.length-1;c>=0;c--)e=l[c],n(e,"selected",!1);n(r,"selected",!0),n(o,"value",s),o.$(".customcolor").colpickSetColor(s,!0)}},willDestroyElement:function(){this._super(),this.$().off("click")}});t.register("component:component-colpick",o)}}),Ember.Application.initializer({name:"component-contextselector",after:["ContextRegistry","HashUtils"],initialize:function(e,t){var i=e.lookupFactory("registry:context"),n=e.lookupFactory("utility:hash"),o=Ember.get,r=Ember.set,s=Ember.String.loc,a=Ember.Component.extend({contexts:i.all,init:function(){this._super(),this.set("store",DS.Store.create({container:this.get("container")}))},destroy:function(){this._super(),this.get("store").destroy()},helpModal:{title:s("Syntax"),content:["<ul>","<li><code>co:regex</code> : ",s("look for a component"),"</li>","<li><code>re:regex</code> : ",s("look for a resource"),"</li>","<li><code>me:regex</code> : ",s("look for a metric"),"(<code>me:</code>",s(" isn't needed for this one"),")</li>","<li>",s("combine all of them to improve your search")," : <code>co:regex re:regex me:regex</code></li>","<li><code>co:</code>, <code>re:</code>, <code>me:</code> : ",s("look for non-existant field"),"</li>","</ul>"].join(""),name:n.generateId("cmetric-help-modal"),label:n.generateId("cmetric-help-modal-label")},actions:{select:function(e){r(this,"content",o(e,"_id"))},search:function(e){if(e){var t=this.build_filter(e);r(this,"contextSearch",t)}else r(this,"contextSearch",null)},clearselection:function(){r(this,"content",void 0)}},build_filter:function(e){var t,i=e.split(" "),n={component:[],resource:[],name:[]};for(t=0;t<i.length;t++){var o=i[t];if(""!==o){var r=o.slice(3)||null;0===o.indexOf("co:")?n.component.push(r):0===o.indexOf("re:")?n.resource.push(r):0===o.indexOf("me:")?n.name.push(r):n.name.push(o)}}var s={$and:[]},a={component:{$or:[]},resource:{$or:[]},name:{$or:[]}};for(var l in a){for(t=0;t<n[l].length;t++){var c={},d=n[l][t];null!==d?c[l]={$regex:d}:c[l]=null,a[l].$or.push(c)}var u=a[l].$or.length;1===u&&(a[l]=a[l].$or[0]),u>0&&s.$and.push(a[l])}return 1===s.$and.length&&(s=s.$and[0]),s},columns:function(){var e=o(this,"contextType"),t=[{name:"name",title:s("Component")},{action:"select",actionAll:o(this,"multiselect")===!0?"selectAll":void 0,title:new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-plus-sign"></span>'),style:"text-align: center;"}];switch(e){case"ctxtopology":return t;case"ctxselector":return t;case"ctxcomponent":return[{name:"connector_name",title:s("Connector name")},{name:"name",title:s("Component")},{action:"select",actionAll:o(this,"multiselect")===!0?"selectAll":void 0,title:new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-plus-sign"></span>'),style:"text-align: center;"}];case"ctxresource":return[{name:"connector_name",title:s("Connector name")},{name:"component",title:s("Component")},{name:"name",title:s("Resource")},{action:"select",actionAll:o(this,"multiselect")===!0?"selectAll":void 0,title:new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-plus-sign"></span>'),style:"text-align: center;"}];default:return[{name:"component",title:s("Component")},{name:"resource",title:s("Resource")},{name:"id",title:s("Metric")},{action:"select",actionAll:o(this,"multiselect")===!0?"selectAll":void 0,title:new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-plus-sign"></span>'),style:"text-align: center;"}]}}.property("contextType")});t.register("component:component-contextselector",a)}}),Ember.Application.initializer({name:"component-dateinterval",after:["HashUtils","DatesUtils"],initialize:function(e,t){var i=e.lookupFactory("utility:hash"),n=e.lookupFactory("utility:dates"),o=Ember.get,r=Ember.set,s=window.moment,a=Ember.Component.extend({init:function(){this._super.apply(this,arguments),r(this,"id",i.generate_GUID())},id:void 0,label:void 0,didInsertElement:function(){var e=this,t=this.$("#"+o(this,"id"));t.daterangepicker({timePickerIncrement:5,timePicker:!0,ranges:{Today:[s(),s()],Yesterday:[s().subtract("days",1),s().subtract("days",1)],"Last 7 Days":[s().subtract("days",6),s()],"Last 30 Days":[s().subtract("days",29),s()],"This Month":[s().startOf("month"),s().endOf("month")],"Last Month":[s().subtract("month",1).startOf("month"),s().subtract("month",1).endOf("month")]},startDate:s().subtract("days",29),endDate:s()},function(t,i,s){r(e,"label",s),console.log(s);var a=parseInt(new Date(t).getTime()/1e3),l=parseInt(new Date(i).getTime()/1e3);console.log("startTimestamp",a,"stopTimestamp",l),a===l&&(console.log("We are on the same day, let compute the start of the day"),a=n.startOfTheDay(),"Yesterday"===s&&(l=a,a-=86400),console.log("NEW -> startTimestamp",a,"stopTimestamp",l));var c={},d={},u=!1;a&&(d.$gte=a,u=!0),l&&(d.$lte=l,u=!0),c=u?{timestamp:d}:{},r(e,"content",c),console.log(o(e,"content"))})}});t.register("component:component-dateinterval",a)}}),Ember.Application.initializer({name:"component-dictclassifiedcrecordselector",after:"component-classifiedcrecordselector",initialize:function(e,t){var i=e.lookupFactory("component:component-classifiedcrecordselector"),n=i.extend({multiselect:!0});t.register("component:component-dictclassifiedcrecordselector",n)}}),Ember.Application.initializer({name:"component-draggablebutton",initialize:function(e,t){var i=Ember.get,n=Ember.Namespace.create();n.Dragable=Ember.Mixin.create({attributeBindings:"draggable",draggable:"true",dragStart:function(e){console.log("drag started !");var t=e.originalEvent.dataTransfer;t.setData("elementId",i(this,"elementId"))}});var o=Ember.Component.extend(n.Dragable,{didInsertElement:function(){this.$().css("display","inline").css("width","5px")}});t.register("component:component-draggablebutton",o)}}),Ember.Application.initializer({name:"component-dropdownbutton",initialize:function(e,t){var i=Ember.set,n=Ember.Component.extend({classNames:["dropdown"],opened:!1,actions:{hideContent:function(){i(this,"opened",!1)}},didInsertElement:function(){var e=this;this.$().parents("td").css("overflow-x","visible").css("overflow-y","visible"),this.$().mouseleave(function(){i(e,"opened",!1)})}});t.register("component:component-dropdownbutton",n)}}),Ember.Application.initializer({name:"component-dropdownbuttoncontent",initialize:function(e,t){var i=Ember.get,n=Ember.Component.extend({classNames:["dropdownbuttoncontent"],classNameBindings:["dropdownContentMenu"],align:"left",init:function(){var e=i(this,"align");this._super(),"right"===e&&i(this,"classNames").pushObject("dropdown-menu-right")},dropdownContentMenu:function(){return i(this,"parentView.opened")}.property("parentView.opened"),attributeBindings:["aria-labelledby"],"aria-labelledby":"dropdownMenu1"});t.register("component:component-dropdownbuttoncontent",n)}}),Ember.Application.initializer({name:"component-dropdownbuttonheader",initialize:function(e,t){var i=Ember.get,n=Ember.Component.extend({tagName:"a",classNameBindings:["classAttribute"],classAttribute:function(){var e=i(this,"parentView.opened"),t="btn btn-secondary dropdown-toggle opening";return e&&(t+=" active"),t}.property("parentView.opened"),attributeBindings:["aria-expanded"],"aria-expanded":"true",click:function(){this.toggle()},toggle:function(){this.toggleProperty("parentView.opened")}});t.register("component:component-dropdownbuttonheader",n)}}),Ember.Application.initializer({name:"component-dropdownbuttonoverview",initialize:function(e,t){var i=Ember.get,n=Ember.Component.extend({classNames:["dropdownbuttonoverview","dropdownbuttonoverview-default","overview"],attributeBindings:["style"],style:function(){var e=i(this,"color");return"background-color:"+e}.property("color")});t.register("component:component-dropdownbuttonoverview",n)}}),Ember.Application.initializer({name:"component-dropdownbuttontitle",initialize:function(e,t){var i=Ember.Component.extend({name:void 0,classNames:["dropdownbuttontitle","dropdownbuttontitle-default"]});t.register("component:component-dropdownbuttontitle",i)}}),Ember.Application.initializer({name:"component-elementidselectorwithoptions",after:["SearchmethodsRegistry","HashUtils"],initialize:function(e,t){var i=e.lookupFactory("registry:searchmethods"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=Ember.String.loc,a=Ember.Component.extend({additionnalSelectionButtons:["removeitembutton"],searchMethod:function(){var e=n(this,"content.model.options.source.searchMethod");return i.getByName(e)}.property("content.model.options.source.searchMethod"),helpModal:function(){return n(this,"searchMethod.help")}.property("searchMethod"),availableDataColumns:function(){for(var e=n(this,"content.model.options.source.columns"),t=Ember.A(),i=0;i<e.length;i++){var o=e[i],r=n(o,"title"),a=n(o,"name");t.pushObject({title:s(r),name:a})}return t.pushObject({action:"select",actionAll:n(this,"multiselect")===!0?"selectAll":void 0,title:new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-plus-sign"></span>'),style:"text-align: center;"}),t}.property("content.model.options.source.columns"),init:function(){r(n(this,"selectedData"))&&o(this,"selectedData",[]),r(n(this,"searchPhrase"))&&o(this,"searchPhrase",null),r(n(this,"multiselect"))&&o(this,"multiselect",!0),o(this,"listedAvailableItems",[]),this._super.apply(this,arguments);var e=DS.Store.create({container:this.get("container")});o(this,"componentDataStore",e);var t={filter:{_id:void 0}},i=this;if(!r(n(this,"content"))){if(n(this,"multiselect")===!0){var s=n(this,"content")||[];t.filter._id={$in:s}}else t.filter._id=n(this,"content");var a=n(this,"content.model.options.source.schema");e.findQuery(a,t).then(function(e){var t=n(e,"content")||[];console.log("Received data:",a,s,t);for(var r=0,a=t.length;a>r;r++)t.pushObject(t[r]);o(i,"listedAvailableItems",t)})}},rendererFor:function(e){var t=n(e,"type"),i=n(e,"options.role");n(e,"model.options.role")&&(i=n(e,"model.options.role"));var o=n(e,"options.items.role");"array"!==i||r(o)||(i=o);var s;return s=i?"renderer-"+i:"renderer-"+t,void 0===Ember.TEMPLATES[s]&&(s=void 0),s},selectedItemHeaderRendererType:function(){return this.rendererFor(n(this,"selectedItemHeaderRendererAttr"))}.property("selectedItemHeaderRendererAttr"),selectedItemHeaderRendererAttr:function(){var e={type:n(this,"content.model.options.items.type"),options:n(this,"content.model.options.items")};return e}.property(),actions:{select:function(e){var t=n(this,"content.value")||[];if(t.indexOf(e)<0){console.log("Select element:",e);var i,r=n(this,"content.model.options.items.polymorphicTypeKey"),s={},a=n(this,"content.model.options.items.typeKeyName");if(r)i=n(e,r);else{var l=n(this,"content.model.options.items.model");l&&(i=n(this,"content.model.options.items.model"))}i&&a&&(s[a]=i);for(var c=n(this,"content.model.options.sourceMappingKeys"),d=0;d<c.length;d++){var u=c[d];s[u.objectKey]=n(e,u.sourceItemKey)}n(this,"multiselect")===!0?t.pushObject(s):t=[s]}o(this,"content.value",t)},unselect:function(e){console.error("unselect",e);var t=n(this,"content.value"),i=t.indexOf(e);i>=0&&(console.log("Unselect element:",e),t.removeAt(i)),o(this,"content.value",t)},selectAll:function(){if(n(this,"multiselect")===!0){var e=n(this,"listedAvailableItems");if(e.length)for(var t=0,i=e.length;i>t;t++)this.send("select",e[t])}},unselectAll:function(){o(this,"selectedData",[])},search:function(e){if(e){var t=n(this,"searchMethod");if(t){var i=t.buildFilter(e);o(this,"searchPhrase",i)}}else o(this,"searchPhrase",null)}}});t.register("component:component-elementidselectorwithoptions",a)}}),Ember.Application.initializer({name:"component-eventkey",after:"EventUtils",initialize:function(e,t){var i=e.lookupFactory("utility:event"),n=Ember.get,o=Ember.set,r=Ember.String.loc,s=Ember.Component.extend({init:function(){this._super(),o(this,"selectedMode",r("List")),o(this,"modes",[r("List"),r("Custom")]);var e=i.getFields();console.log("eventFields",e);for(var t=[],n=e.length,s=0;n>s;s++)t.push({field:e[s]});o(this,"selectableProperties",t)},useTextField:function(){return n(this,"selectedMode")===r("Custom")}.property("selectedMode"),useList:function(){return n(this,"selectedMode")===r("List")}.property("selectedMode"),testActive:function(){for(var e=n(this,"selectableProperties"),t=e.length,i=0;t>i;i++){var r=e[i].field===n(this,"content");o(e[i],"isActive",r),console.log("compare",e[i].field,"and",n(this,"content"))}}.observes("content"),actions:{setProperty:function(e){o(this,"content",e),console.log("content is now",n(this,"content"))}}});t.register("component:component-eventkey",s)}}),Ember.Application.initializer({name:"component-filefield",initialize:function(e,t){var i=Ember.isEmpty,n=Ember.TextField.extend(Ember.Evented,{type:"file",attributeBindings:["multiple"],multiple:!1,change:function(e){var t=e.target;i(t.files)||this.send("onFileUpload",t.files)}});t.register("component:component-filefield",n)}}),Ember.Application.initializer({name:"component-filterclause",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({tagName:"span",classNames:"filterclause",editionMode:!1,init:function(){this._super(arguments),console.log("ComponentFilterclauseComponent init"),console.log(this.get("content")),console.log(this.get("content.operator")),this.get("content.key")?this.finalized=!0:this.finalized=!1},finalized:!1,actions:{editAndClause:function(){this.set("editionMode",!0)},startEditClause:function(){this.get("content").set("filling",!0)},removeAndClause:function(e,t){this.get("parent").send("removeAndClause",e,t)},onAddKey:function(e){console.log("onAddKey",e);var t=this.get("clauses"),i=this.get("currentClauseIndex");if(i>=0){var n=t.objectAt(i),o=n.and[n.and.length-1];if(console.log("focusOutInput",n,o.options.available_indexes),this.get("onlyAllowRegisteredIndexes")===!0){console.group("onlyAllowRegisteredIndexes check");for(var r=0;r<o.options.available_indexes.length;r++){var s=o.options.available_indexes[r];console.log("currentIndex",s),s.value===e&&(console.log("currentIndex validated",s,e),o.set("key",e))}console.groupEnd()}else o.set("key",e)}return!0},focusOutKeyInput:function(){console.log("focusOutInput",arguments)},validateClause:function(e){var t=i(this,"content.value"),o=i(this,"content.key"),r=e.clause.and;if(console.log("focusOutInput",arguments),void 0!==t&&null!==t&&""!==t){var s=i(this,"clauses"),a=i(this,"currentClauseIndex");if(a>=0&&this.keyIsValid(o,r)){var l=s.objectAt(a);console.log("focusOutInput",l),n(this,"content.value",t),n(this,"content.finalized",!0),n(this,"content.filling",!1);var c=i(this,"finalized");n(this,"finalized",!0),i(this,"parent").send("addAndClause",c),n(this,"editionMode",!1)}}}},keyIsValid:function(e,t){var n=i(this,"currentClauseIndex"),o=i(this,"clauses"),r=o.objectAt(n);if(console.log("keyIsValid",e,n,r,t),this.get("onlyAllowRegisteredIndexes")!==!0||void 0===t.options.available_indexes)return!0;console.group("onlyAllowRegisteredIndexes check");for(var s=0,a=t.options.available_indexes.length;a>s;s++){var l=t.options.available_indexes[s];if(console.log("currentIndex",l),l.value===e)return console.log("currentIndex validated",l,e),t.set("key",e),!0}return console.groupEnd(),!1}});t.register("component:component-filterclause",o)}}),Ember.Application.initializer({name:"component-formulaeditor",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.String.loc,s=Ember.Component.extend({form:Ember.computed.alias("parentView.parentView.controller"),metrics_cols:[{name:"component",title:r("Component")},{name:"resource",title:r("Resource")},{name:"id",title:r("Metric")},{action:"insert",actionAll:void 0,title:new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-plus-sign"></span>'),style:"text-align: center;"}],init:function(){n(this,"selectedMetrics",Ember.A()),this._super.apply(this,arguments);for(var e=i(this,"form.categories"),t=!1,o=0,r=e.length;r>o;o++){for(var s=e[o],a=0,l=s.keys.length;l>a;a++){var c=s.keys[a];if("metrics"===c.field){Ember.addObserver(c,"value",this,this.metricDidChange),t=!0;break}}if(t)break}},metricDidChange:function(e,t){for(var o=i(e,t),r=[],s=0,a=o.length;a>s;s++){var l=o[s].split("/"),c=l.length;l=7===c?{component:l[c-3],resource:l[c-2],id:l[c-1]}:{component:l[c-2],resource:null,id:l[c-1]},r.push(l)}n(this,"selectedMetrics",r)},actions:{insert:function(e){var t=" "+["",i(e,"component"),i(e,"resource")||"",i(e,"id")].join("/"),r=i(this,"content.value");o(r)?n(this,"content.value",t):n(this,"content.value",r+t)}}});t.register("component:component-formulaeditor",s)}}),Ember.Application.initializer({name:"component-ical",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.String.loc,s=window.RRule,a=Ember.Component.extend({helpFrequency:"How often the rule is applied",helpRepetitionInterval:"Time space between two repetitions",
helpRepetitionCount:"How many times action is repeated",helpStartDate:"Since when to apply rule",helpStopDate:"Until when to apply rule",frequencyForm:[{value:s.YEARLY,label:r("Yearly")},{value:s.MONTHLY,label:r("Monthly")},{value:s.WEEKLY,label:r("Weekly")},{value:s.DAILY,label:r("Daily")},{value:s.HOURLY,label:r("Hourly")},{value:s.MINUTELY,label:r("Minutely")},{value:s.SECONDLY,label:r("Secondly")}],init:function(){this._super();var e=DS.Model.extend({label:DS.attr()});e.FIXTURES=i(this,"months"),n(this,"rules",[]),n(this,"frequencySelection",s.YEARLY),console.log("rrule information",i(this,"frequencyForm"));var t=i(this,"content");if(!o(t)&&Ember.isArray(t))for(var r=t.length,a=0;r>a;a++)try{var l=s.fromString(t[a]),c={value:l.toText(),instance:l};i(this,"rules").pushObject(c)}catch(d){console.warn("Unable to parse rrule from given information",t[a],d)}else console.log("no content available for initialization");this.updateContent()},actions:{removeRule:function(e){i(this,"rules").removeObject(e),this.updateContent()},addRule:function(){var e={},t=i(this,"startDate");o(t)||isNaN(t)||(e.dtstart=new Date(1e3*t));var n=i(this,"stopDate");o(n)||isNaN(n)||(e.until=new Date(1e3*n));var r=i(this,"repetitionCount");o(r)||isNaN(r)||(e.count=parseInt(r));var a=i(this,"repetitionInterval");o(a)||isNaN(a)?(console.log("rrule inteval default value set to 30 as no value set"),e.interval=30):e.interval=parseInt(a);var l=i(this,"frequencySelection");console.log("generated rrule options",e,"frequencySelection ",l);var c=new s(l,e),d={value:c.toText(),instance:c};i(this,"rules").pushObject(d),this.updateContent()}},updateContent:function(){for(var e=[],t=i(this,"rules"),o=t.length,r=0;o>r;r++)e.push(t[r].instance.toString());console.log("generated rules",e),n(this,"content",e)},didInsertElement:function(){console.log("recurrence input loaded",this.$())}});t.register("component:component-rrule",a)}}),Ember.Application.initializer({name:"component-labelledlink",initialize:function(e,t){var i=Ember.String.loc,n=Ember.Component.extend({label_placeholder:i("label"),url_placeholder:i("url"),content:void 0});t.register("component:component-labelledlink",n)}}),Ember.Application.initializer({name:"component-linklist",after:["DatesUtils","DataUtils"],initialize:function(e,t){var i=e.lookupFactory("utility:data"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=window.Handlebars,a=Ember.Component.extend({link_types:["computed_links","event_links"],links:void 0,init:function(){this._super(),o(this,"links",Ember.A())},didInsertElement:function(){console.log("Inserted element linklist, setting td parent overflow to visible"),this.$().parents("td").css("overflow-x","visible").css("overflow-y","visible"),this.loadLinks()},linksFromApi:function(e){var t=this,o=i.getEmberApplicationSingleton().__container__.lookup("adapter:entitylink");console.log("event",e),o.findEventLinks("entitylink",{event:JSON.stringify(e)}).then(function(i){console.log("links from api results",i);var o=t.link_types;if(i.success){var s=i.data;if(s.length){var a=s[0];console.log("links_information",a);for(var l=o.length,c=0;l>c;c++){var d=a[o[c]];if(console.log("search",o[c],"in links_information",d),!r(d)&&Ember.isArray(d))for(var u=d.length,p=0;u>p;p++)d[p].url=t.compute_url(e,d[p].url),n(t,"links").pushObject(d[p])}}}})},compute_url:function(e,t){var i=s.compile(t)(e);return console.log("handlebars url",i,e),i},loadLinks:function(){if(n(this,"loaded"))console.log("Links already loaded");else{var e=n(this,"record").toJson();console.log("loading links for event",e),this.linksFromApi(e),o(this,"loaded",!0)}}});t.register("component:component-linklist",a)}}),Ember.Application.initializer({name:"component-listtree",initialize:function(e,t){var i=Ember.get,n=Ember.Namespace.create();n.cancel=function(e){return e.preventDefault(),!1},n.Droppable=Ember.Mixin.create({dragEnter:n.cancel,dragOver:n.cancel,drop:function(e){console.log("drop done !");var t=e.originalEvent.dataTransfer.getData("elementId"),n=Ember.View.views[t],o=i(n,"content"),r=i(this,"content");return console.log("clause",o),console.log("condition",r),o.detach(),o.attach(r),n.destroy(),e.preventDefault(),!1}});var o=Ember.Component.extend(n.Droppable,{});t.register("component:component-listtree",o)}}),Ember.Application.initializer({name:"component-miniform",initialize:function(e,t){var i=Ember.Component.extend({classNames:["panel","panel-default"],attributeBindings:["style"],style:"margin-bottom:0"});t.register("component:component-miniform",i)}}),Ember.Application.initializer({name:"component-miniformcontent",initialize:function(e,t){var i=Ember.Component.extend({classNames:["panel-collapse","collapse","in"],formBase:Ember.computed.alias("parentView")});t.register("component:component-miniformcontent",i)}}),Ember.Application.initializer({name:"component-miniformheader",initialize:function(e,t){var i=Ember.Component.extend({classNames:["panel-heading"]});t.register("component:component-miniformheader",i)}}),Ember.Application.initializer({name:"component-miniformheaderbuttons",initialize:function(e,t){var i=Ember.Component.extend({classNames:["fright"]});t.register("component:component-miniformheaderbuttons",i)}}),Ember.Application.initializer({name:"component-miniformtitle",initialize:function(e,t){var i=Ember.get,n=Ember.Component.extend({formBase:Ember.computed.alias("parentView.parentView"),actions:{toggleContent:function(){i(this,"formBase").toggleProperty("contentShown")}}});t.register("component:component-miniformtitle",n)}}),Ember.Application.initializer({name:"component-mixinselector",after:"MixinsRegistry",initialize:function(e,t){var i=e.lookupFactory("registry:mixins"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=Ember.Component.extend({init:function(){this._super.apply(this,arguments),r(n(this,"content"))&&o(this,"content",Ember.A()),o(this,"selectionPrepared",Ember.A());var e=n(this,"content");if(e)for(var t=0,i=e.length;i>t;t++)"string"==typeof e[t]&&(e[t]={name:e[t]});o(this,"selectionPrepared",e)},classifiedItems:i,selectionPrepared:void 0,content:void 0,selectionUnprepared:Ember.computed.alias("content"),recomputeSelection:function(){var e=n(this,"selectionPrepared");console.log("recomputeSelection",e,n(this,"selectionPrepared"));var t=n(this,"content"),i=Ember.A();if(e)for(var r=0,s=e.length;s>r;r++){var a,l=e[r],c=n(l,"name"),d=t.findBy("name",c);a=d?d:{name:c},i.pushObject(a)}o(this,"content",i)},actions:{selectItem:function(){this.recomputeSelection()},unselectItem:function(){this.recomputeSelection()}}});t.register("component:component-mixinselector",s)}}),Ember.Application.initializer({name:"component-modelselect",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({model:function(){var e=i(this,"content.model.options.model"),t=e.split("."),n=t[t.length-1].capitalize();return n}.property("content.model.options.model"),newModelSelected:function(){var e=i(this,"selectedModel");console.log("Select record:",e),n(this,"content.value",i(e,"id"))}.observes("selectedModel"),availableModels:function(){var e=i(this,"componentDataStore"),t=i(this,"model");return e.findAll(t.dasherize())}.property("model"),init:function(){this._super.apply(this,arguments);var e=DS.Store.create({container:i(this,"container")});n(this,"componentDataStore",e);var t,o=i(this,"content.value"),r=this;if(o){console.log("Select model instance:",o);var s=i(this,"model");t=e.find(s,o),t.then(function(e){n(r,"selectedModel",e)})}else console.log("Select first available model"),t=i(this,"availableModels"),t.then(function(e){var t=e.content[0];n(r,"selectedModel",t)})}});t.register("component:component-modelselect",o)}}),Ember.Application.initializer({name:"component-password",after:"HashUtils",initialize:function(e,t){var i=e.lookupFactory("utility:hash"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=Ember.Component.extend({method:void 0,content:void 0,init:function(){this._super.apply(this,arguments);var e=["sha1","md5"],t=n(this,"method");r(t)||-1!==e.indexOf(t)||(console.warning("Invalid method, using sha1:",t),o(this,"method","sha1"))},onUpdate:function(){var e=n(this,"password"),t=n(this,"method");if(!r(t)){var s=n(i,t);e=s(e)}o(this,"content",e)}.observes("password")});t.register("component:component-password",s)}}),Ember.Application.initializer({name:"component-propertiestopopup",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=window.json2html,s=Ember.Component.extend({init:function(){this._super();var e;try{if(e=JSON.parse(i(this,"properties")),!Ember.isArray(e))throw"Not an array"}catch(t){console.warn("Unable to parse properties list"),e=[]}n(this,"propertieslist",e)},propertiesAsHtml:function(){var e=i(this,"propertieslist"),t=e.length,n=i(this,"source");if(o(n))return"";var s,a;for(s=i(this,"propertiesOnly")?[]:{},a=0;t>a;a++){var l=i(n,e[a]);o(l)||(i(this,"propertiesOnly")?s.push(l):s[e[a]]=l)}var c=r(s);return i(this,"htmlOnly")?c:c.toString()}.property(),icon:function(){var e=i(this,"customIcon");return o(e)?"glyphicon-eye-open":e}.property()});t.register("component:component-propertiestopopup",s)}}),Ember.Application.initializer({name:"component-restobjectcombo",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({schemaType:void 0,selectedValue:void 0,valueField:void 0,labelField:void 0,valuePath:void 0,isLoading:!0,init:function(){this._super(),n(this,"store",DS.Store.create({container:this.get("container")}))},destroy:function(){i(this,"store").destroy()},categorizeElements:function(e){function t(e,t){void 0===n[e]&&(n[e]=Ember.A()),t.get(i(o,"valueField"))===i(o,"selectedValue")?n[e].pushObject({label:i(t,i(o,"labelField")),value:i(t,i(o,"valueField")),selected:!0}):n[e].pushObject({label:i(t,i(o,"labelField")),value:i(t,i(o,"valueField"))})}for(var n={},o=this,r=0,s=e.length;s>r;r++){var a=i(e[r],"tags");if(a&&a.length)for(var l=0,c=a.length;c>l;l++)t(a[l],e[r]);else t("untagged",e[r])}var d=Ember.keys(n),u=Ember.A();for(r=0;r<d.length;r++)u.pushObject({name:d[r],content:n[d[r]]});return console.log("res",u),u},filteredElements:function(){var e=this;if(i(this,"searchCriterion")){var t=i(this,"searchCriterion"),n=i(this,"content").filter(function(n){console.log("item",n);var o=n.get(i(e,"labelField")).slice(0,t.length)==t,r=n.get("tags");if(r)for(var s=0,a=r.length;a>s;s++){var l=r[s].slice(0,t.length)==t;if(l)return!0}return o});return this.categorizeElements(n)}return this.categorizeElements(i(this,"content"))}.property("content","searchCriterion"),didInsertElement:function(){var e=this,t=i(this,"valuePath")||"attr.value";i(this,"store").findQuery(i(this,"schemaType"),{limit:1e4}).then(function(i){n(e,"isLoading",!1),n(e,"content",i.get("content")),Ember.run.schedule("afterRender",function(){e.$("select").on("change",function(){console.log("select value",this.value),n(e,t,this.value)})})})},willDestroyElement:function(){this.$("select").off("change")}});t.register("component:component-restobjectcombo",o)}}),Ember.Application.initializer({name:"component-rrule",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.String.loc,s=window.RRule,a=Ember.Component.extend({helpFrequency:"How often the rule is applied",helpRepetitionInterval:"Time space between two repetitions",helpRepetitionCount:"How many times action is repeated",helpStartDate:"Since when to apply rule",helpStopDate:"Until when to apply rule",frequencyForm:[{value:s.YEARLY,label:r("Yearly")},{value:s.MONTHLY,label:r("Monthly")},{value:s.WEEKLY,label:r("Weekly")},{value:s.DAILY,label:r("Daily")},{value:s.HOURLY,label:r("Hourly")},{value:s.MINUTELY,label:r("Minutely")},{value:s.SECONDLY,label:r("Secondly")}],init:function(){this._super();var e=DS.Model.extend({label:DS.attr()});e.FIXTURES=i(this,"months"),n(this,"rules",[]),n(this,"frequencySelection",s.YEARLY),console.log("rrule information",i(this,"frequencyForm"));var t=i(this,"content");if(!o(t)&&Ember.isArray(t))for(var r=t.length,a=0;r>a;a++)try{var l=s.fromString(t[a]),c={value:l.toText(),instance:l};i(this,"rules").pushObject(c)}catch(d){console.warn("Unable to parse rrule from given information",t[a],d)}else console.log("no content available for initialization");this.updateContent()},actions:{removeRule:function(e){i(this,"rules").removeObject(e),this.updateContent()},addRule:function(){var e={},t=i(this,"startDate");o(t)||isNaN(t)||(e.dtstart=new Date(1e3*t));var n=i(this,"stopDate");o(n)||isNaN(n)||(e.until=new Date(1e3*n));var r=i(this,"repetitionCount");o(r)||isNaN(r)||(e.count=parseInt(r));var a=i(this,"repetitionInterval");o(a)||isNaN(a)?(console.log("rrule inteval default value set to 30 as no value set"),e.interval=30):e.interval=parseInt(a);var l=i(this,"frequencySelection");console.log("generated rrule options",e,"frequencySelection ",l);var c=new s(l,e),d={value:c.toText(),instance:c};i(this,"rules").pushObject(d),this.updateContent()}},updateContent:function(){for(var e=[],t=i(this,"rules"),o=t.length,r=0;o>r;r++)e.push(t[r].instance.toString());console.log("generated rules",e),n(this,"content",e)}});t.register("component:component-rrule",a)}}),Ember.Application.initializer({name:"component-searchbar",initialize:function(e,t){var i=Ember.get,n=Ember.Component.extend({showSearchOptions:!1,tagName:"span",actions:{searchInputAction:function(){var e=i(this,"value");console.log("searchItems",this,this.controller,e),i(this,"controller").target.set("searchCriterion",e)},clearSearch:function(){console.log("clear search field"),this.set("value",""),this.controller.target.set("searchFieldValue",""),this.send("searchInputAction","")}},tabAllId:function(){return console.log("tabAllId"),i(this,"elementId")+"TabAll"}.property("elementId"),tabIndexedId:function(){return i(this,"elementId")+"TabIndexed"}.property("elementId"),tabFilterId:function(){return i(this,"elementId")+"TabFilter"}.property("elementId"),tabAllHref:function(){return"#"+i(this,"elementId")+"TabAll"}.property("elementId"),tabIndexedHref:function(){return"#"+i(this,"elementId")+"TabIndexed"}.property("elementId"),tabFilterHref:function(){return"#"+i(this,"elementId")+"TabFilter"}.property("elementId")});t.register("component:component-searchbar",n)}}),Ember.Application.initializer({name:"component-sessioneditor",after:"DataUtils",initialize:function(e,t){var i=e.lookupFactory("utility:data"),n=Ember.get,o=Ember.set,r=Ember.Component.extend({fieldValue:function(){var e=this.get("attr.model.options.valueFrom"),t=i.getLoggedUserController(),n=t.get("record."+e);return console.group("editor-session"),console.log("key:",e),console.log("value:",n),console.groupEnd(),n}.property("attr.field"),init:function(){this._super(arguments),void 0===n(this,"attr.value")&&o(this,"attr.value",n(this,"fieldValue"))}});t.register("component:component-sessioneditor",r)}}),Ember.Application.initializer({name:"component-simpledicteditor",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.Component.extend({content:void 0,actions:{addKey:function(){var e=i(this,"newValue"),t=i(this,"newKey");o(i(this,"content"))&&n(this,"content",{}),o(e)||o(t)||(n(this,"content."+t,e),this.contentChanged(),n(this,"newKey"),n(this,"newValue"))},select:function(){console.warn("select",arguments)},removeKey:function(e){delete this.content[e],this.contentChanged()}},didInsertElement:function(){this._super.apply(this),this.contentChanged()},contentChanged:function(){var e=Ember.A(),t=i(this,"content");if(t){var o=Ember.keys(t);console.warn(t,o);for(var r=0,s=o.length;s>r;r++){var a=o[r];e.pushObject(Ember.Object.create({key:a,value:t[a]}))}console.warn("dictAsArray",e),n(this,"dictAsArray",e)}}});t.register("component:component-simpledicteditor",r)}}),Ember.Application.initializer({name:"component-slider",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.Component.extend({init:function(){this._super()},didInsertElement:function(){var e=this,t=i(this,"options"),r=i(t,"min")||0,s=i(t,"max")||100,a=i(t,"step")||1,l=parseInt(i(e,"content"));(o(l)||isNaN(l))&&(l=i(t,"default")||r),console.log("slider options",{min:r,max:s,step:a,value:l});var c=e.$("#range_slider");c.ionRangeSlider({min:r,max:s,from:l,type:"single",step:a,prefix:"",onChange:function(t){n(e,"content",i(t,"from"))}});var d=function(){var t=e.$(".irs-line");if(void 0!==t)if(t.is(":visible")){var i=t.width(),n=i/s*l,o=i-20;n>o&&(n=o),e.$(".irs-single").css("left",n),e.$(".irs-slider").css("left",n)}else setTimeout(d,500)};d()}});t.register("component:component-slider",r)}}),Ember.Application.initializer({name:"component-stringclassifiedcrecordselector",after:"component-classifiedcrecordselector",initialize:function(e,t){var i=e.lookupFactory("component:component-classifiedcrecordselector"),n=Ember.get,o=Ember.set,r=i.extend({multiselect:!1,selectionChanged:function(){var e,t=n(this,"selectionUnprepared")[0],i=n(this,"valueKey");Ember.isNone(t)||(e=i?n(t,"value"):n(t,"name"),console.log("selection changed",e)),o(this,"selection",e)}.observes("selectionUnprepared","selectionUnprepared.@each")});t.register("component:component-stringclassifiedcrecordselector",r)}}),Ember.Application.initializer({name:"component-tabcontent",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.Component.extend({tabContainer:Ember.computed.alias("parentView.parentView"),classNames:["tab-pane"],attributeBindings:["role","data-ref"],role:"tab","data-ref":Ember.computed.alias("ref"),active:!1,init:function(){n(this,"elementId",i(this,"tabContainer.elementId")+"-"+i(this,"ref")),i(this,"active")&&i(this,"active")===!0?i(this,"classNames").pushObject("active"):i(this,"classNames").removeObject("active"),this._super()}});t.register("component:component-tabcontent",o)}}),Ember.Application.initializer({name:"component-tabheader",initialize:function(e,t){var i=Ember.get,n=Ember.Component.extend({tagName:"li",attributeBindings:["data-toggle","role","data-ref"],"data-toggle":"tab",role:"tab","data-ref":Ember.computed.alias("ref"),href:function(){var e=i(this,"tabContainer.elementId");return"#"+e+"-"+i(this,"ref")}.property("tabContainer","ref"),tabContainer:Ember.computed.alias("parentView.parentView")});t.register("component:component-tabheader",n)}}),Ember.Application.initializer({name:"component-table",after:"PaginationMixin",initialize:function(e,t){var i=e.lookupFactory("mixin:pagination"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=Ember.Component.extend(i,{model:void 0,modelfilter:void 0,data:void 0,columns:[],items:[],mixinOptions:{pagination:{itemsPerPage:5}},onDataChange:function(){this.refreshContent()}.observes("data.@each"),onModelFilterChange:function(){o(this,"currentPage",1),this.refreshContent()}.observes("modelfilter"),init:function(){this._super(arguments),r(n(this,"model"))||o(this,"store",DS.Store.create({container:n(this,"container")})),o(this,"widgetDataMetas",{total:0}),r(n(this,"items"))&&o(this,"items",[])},didInsertElement:function(){this.refreshContent()},refreshContent:function(){this._super(arguments),this.findItems(),console.log(n(this,"widgetDataMetas"))},findItems:function(){try{var e=this,t=n(this,"store"),i=n(this,"model"),r=n(this,"modelfilter"),s={limit:n(this,"paginationMixinFindOptions.limit")},a=n(this,"queryStartOffsetKeyword")||"skip";if(s[a]=n(this,"paginationMixinFindOptions.start"),void 0!==i)null!==r&&(s.filter=r),t.findQuery(i,s).then(function(t){console.log("Received data for table:",t),o(e,"widgetDataMetas",n(t,"meta")),o(e,"items",n(t,"content"))});else{var l=n(this,"data").slice(s.skip,s.skip+s.limit);o(this,"widgetDataMetas",{total:n(this,"data.length")}),o(this,"items",l)}}catch(c){console.warn("extractItems not updated:",c)}},actions:{"do":function(e,t){this.targetObject.send(e,t)}}});t.register("component:component-table",s)}}),Ember.Application.initializer({name:"component-tabs",initialize:function(e,t){var i=Ember.Component.extend({});t.register("component:component-tabs",i)}}),Ember.Application.initializer({name:"component-tabscontentgroup",initialize:function(e,t){var i=Ember.Component.extend({classNames:["tab-content"]});t.register("component:component-tabscontentgroup",i)}}),Ember.Application.initializer({name:"component-tabsheadergroup",initialize:function(e,t){var i=Ember.Component.extend({tagName:"ul",classNames:["nav","nav-tabs"]});t.register("component:component-tabsheadergroup",i)}}),Ember.Application.initializer({name:"component-textwithsortoption",initialize:function(e,t){var i=Ember.get,n=Ember.set,o=Ember.isNone,r=Ember.Component.extend({directionTypes:["ASC","DESC"],property:void 0,direction:void 0,content:void 0,init:function(){this._super.apply(this,arguments),o(this.get("content"))||(n(this,"property",i(this,"content.property")),n(this,"direction",i(this,"content.direction")))},onUpdate:function(){this.set("content",{property:i(this,"property"),direction:i(this,"direction")}),console.debug("update sortable content",i(this,"content"))}.observes("property","direction")});t.register("component:component-textwithsortoption",r)}}),Ember.Application.initializer({name:"component-timestamptooltiped",after:"DatesUtils",initialize:function(e,t){var i=e.lookupFactory("utility:dates"),n=Ember.get,o=Ember.String.loc,r=Ember.Component.extend({showMainTimestamp:function(){var e=n(this,"maintitle"),t=n(this,"maintimestamp");return o(e)+"<br/><i>"+i.timestamp2String(t)+"</i>"}.property(),showOptionalElapsed:function(){var e=n(this,"optionaltimestamp");return i.durationFromNow(e)}.property()});t.register("component:component-timestamptooltiped",r)}}),Ember.Application.initializer({name:"component-typedvalue",after:"ValuesUtils",initialize:function(e,t){var i=e.lookupFactory("utility:values"),n=Ember.get,o=Ember.set,r=Ember.String.loc,s=Ember.Component.extend({init:function(){this._super(),o(this,"selectedValueType","String"),o(this,"valuesTypes",["String","Number","Boolean"]);var e,t;if(console.log("Init content for typed value is",n(this,"content")),Ember.isNone(n(this,"content")))e="",t="";else{t=e=n(this,"content");var i=(typeof e).capitalize();o(this,"selectedValueType",i)}o(this,"content",t),o(this,"value",e)},updateContent:function(){console.log("get content from typed value:",n(this,"value"));var e=i.castValue(n(this,"value"),n(this,"selectedValueType"));o(this,"content",e),o(this,"contentType",typeof e)}.observes("value"),placeholder:function(){var e="Type a value";switch(n(this,"selectedValueType")){case"Number":e="Use an integer value or a decimal";break;case"String":e="Type a value"}return r(e)}.property("selectedValueType"),updateContentType:function(){var e=n(this,"selectedValueType");"String"===e&&o(this,"value",""),"Number"===e&&o(this,"value",0),"Boolean"===e&&o(this,"value",!0),"Array"===e&&o(this,"value",{value:["toto"]}),console.log("updated content type with value",n(this,"value"))}.observes("selectedValueType"),useTextField:function(){return"String"===n(this,"selectedValueType")||"Number"===n(this,"selectedValueType")}.property("selectedValueType"),useBoolean:function(){return"Boolean"===n(this,"selectedValueType")}.property("selectedValueType"),useArray:function(){return"Array"===n(this,"selectedValueType")}.property("selectedValueType"),actions:{switchContentValue:function(){o(this,"value",!n(this,"value")),console.log("switched boolean value",n(this,"value"))},addListElement:function(){n(this,"value").pushObject("")},removeItem:function(e){n(this,"value").removeObject(e)}}});t.register("component:component-typedvalue",s)}}),function(){Ember.Handlebars.helper("color",function(e){var t="";if(e&&"#null"!==e.toLowerCase()){"#"===e[0]&&(e=e.slice(1));var i=parseInt("FFFFFF",16),n=parseInt("888888",16),o=parseInt("444444",16),r=parseInt(e,16),s=i-r,a=s-n;0>a?(a=-a,o>=a&&(s-=o-a)):o>=a&&(s+=o-a),s=s.toString(16);var l=parseInt(s.substring(0,2),16),c=parseInt(s.substring(2,4),16),d=parseInt(s.substring(4,6),16);s=(l+c+d)/3,s=parseInt(s.toFixed()),s=s.toString(16),s=s+s+s;var u="background-color: #"+e+";";u+="color: #"+s+";",t='style="'+u+'"'}else e="no color";return new Ember.Handlebars.SafeString('<div class="color" '+t+">"+e+"</div>")})}(),Ember.Application.initializer({name:"Compare",initialize:function(e,t){var i=window.Handlebars,n=function(e,t,i){if(arguments.length<3)throw new Error("Handlebars Helper 'compare' needs 2 parameters");var n=i.hash.operator||"==",o={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},lt:function(e,t){return t>e},gt:function(e,t){return e>t},lte:function(e,t){return t>=e},gte:function(e,t){return e>=t},"typeof":function(e,t){return typeof e==t}};if(!o[n])throw new Error('Handlebars Helper "compare" doesn\'t know the operator '+n);var r=o[n](e,t);return r?i.fn(this):i.inverse(this)};i.registerHelper("compare",n),Ember.Handlebars.helper("compare",n)}}),function(){var e=Ember.isNone,t=Ember.String.loc,i={check:{color:"green",icon:"certificate"},consolidation:{color:"green",icon:"cogs"},log:{color:"black",icon:"clock-o"},perf:{color:"grey",icon:"pie-chart"},selector:{color:"green",icon:"eye"},sla:{color:"green",icon:"warning"},topology:{color:"green",icon:"code-fork"},eue:{color:"green",icon:"cog"},calendar:{color:"blue",icon:"calendar"},comment:{color:"blue",icon:"comment"},trap:{color:"blue",icon:"wrench"},user:{color:"blue",icon:"male"},ack:{color:"purple",icon:"check"},downtime:{color:"yellow",icon:""},cancel:{color:"yellow",icon:"trash"},uncancel:{color:"yellow",icon:"reply"},ackremove:{color:"purple",icon:"close"},assocticket:{color:"yellow",icon:"thumb-tack"}};Ember.Handlebars.helper("eventtype",function(n){if(e(i[n]))return n;var o=i[n],r='<span class="badge bg-%@"><i class="fa fa-%@"></i> %@</span>'.fmt(o.color,o.icon,t(n));return new Ember.Handlebars.SafeString(r)})}(),function(){Ember.Handlebars.helper("glyphicon",function(e){return new Ember.Handlebars.SafeString('<span class="glyphicon glyphicon-'+e+'"></span>')})}(),Ember.Application.initializer({name:"HumanReadableHelper",after:["ValuesUtils"],initialize:function(e,t){var i=e.lookupFactory("utility:values"),n=Ember.get,o=Ember.isNone,r=Ember.String.loc,s=window.Handlebars,a=function(e,t){var s,a=e;o(t)&&(t=e,a=n(t,"hash.value"));var l=n(t,"hash.unit")||"";return s=isNaN(a)?r("Not a valid number"):i.humanize(a,l),new Ember.Handlebars.SafeString(s)};s.registerHelper("hr",a),Ember.Handlebars.helper("hr",a)}}),Ember.Application.initializer({name:"Interval2htmlHelper",after:"DatesUtils",initialize:function(e,t){var i=e.lookupFactory("utility:dates"),n=Ember.isNone,o=Ember.String.loc;Ember.Handlebars.helper("interval2html",function(e,t){var r="";return n(e)||(r+=o("From")+" "+i.timestamp2String(e)),n(e)||n(t)||(r+=" "),n(t)||(r+=o("to")+" "+i.timestamp2String(t)),console.debug("generated html form interval2html is",r),r})}}),function(){var e=Ember.set,t=Ember.isNone,i=Ember.isArray,n=function(n,o){function r(e){var t="";if(i(e)){t+='<ul class="jsonUl">';for(var n=e.length,o=0;n>o;o++)t+='<li class="jsonLi">'+r(e[o])+"</li>";t+="</ul>"}else if("object"==typeof e)for(var s in e)t+='<ul class="jsonUl"><li class="jsonLi">',t+='<span class="label label-primary">'+s+"</span>",t+="object"==typeof e[s]||i(e[s])?r(e[s]):'&nbsp;<span class="glyphicon glyphicon-arrow-right" style="display:inline"></span><span class="label label-warning">'+e[s]+"</span>",t+="</li></ul>";else t+='&nbsp;<span class="glyphicon glyphicon-arrow-right" style="display:inline"></span><span class="label label-warning">'+e+"</span>";return t}if("string"==typeof n)try{n=JSON.parse(n)}catch(s){console.error("unable to deserialize json"),n={invalid:"json string"}}var a=r(n);return console.info("json2html",{data:n,"settable object:":o,html:a,arguments:arguments}),!t(o)&&arguments.length>2&&(console.log("processing set html to the settable item"),e(o,"json2html",a),a=""),new Ember.Handlebars.SafeString(a)};Ember.Handlebars.helper("json2html",n),window.json2html=n}(),function(){var e="/static/canopsis/media/images/",t={nagios:e+"nagioslogo.png",shinken:e+"shinkenlogo.png",schneider:e+"schneiderlogo.png",collectd:e+"collectd.jpg",sikuli:e+"sikulilogo.png",cucumber:e+"cucumberlogo.png",watir:e+"watirlogo.png",jmeter:e+"jmeterlogo.jpg",centreon:e+"centreonlogo.png",Engine:e+"engine.png"};Ember.Handlebars.helper("logo",function(e){var i=t[e];return void 0!==i?'<img alt="Source" src="'+i+'"/>':e}),Ember.Handlebars.helper("logofromstring",function(e){var i=t[e];return i}),Ember.Handlebars.helper("logofromstring2",function(e){var i=t[e];return'<img alt="Source" src="'+i+'"/>'})}(),function(){Ember.Handlebars.helper("percent",function(e){return e+="%",new Ember.Handlebars.SafeString(e)})}(),Ember.Handlebars.helper("rights",function(e){var t=["r","w"],i=["eye","pencil"],n="",o=' <span class="label label-%@"><span class="fa fa-%@" style="color:white"></span></span>';return t.forEach(function(t,r){var s;s=e&&void 0!==e.contains&&e.contains(t)?"success":"default",n+=o.fmt(s,i[r])}),n}),Ember.Handlebars.helper("sorticon",function(e){var t;if("sorting_desc"===e)t='<i class="fa fa-caret-down"></i>';else{if("sorting_asc"!==e)return;t='<i class="fa fa-caret-up"></i>'}return t}),Ember.Application.initializer({name:"TimesinceHelper",after:"DatesUtils",initialize:function(e,t){var i=e.lookupFactory("utility:dates"),n=Ember.String.loc;Ember.Handlebars.helper("timeSince",function(e,t){if(e||t.timeStampState){if(e=t.timeStampState||e,i.isToday(e))return n("Today");var o=i.durationFromNow(e);return o}return""})}}),Ember.Application.initializer({name:"TimestampHelper",after:"DatesUtils",initialize:function(e,t){var i=e.lookupFactory("utility:dates"),n=Ember.get,o=Ember.isNone;Ember.Handlebars.helper("timestamp",function(e,t,r){o(r)||(e=n(r,"timeStampState")||e),e&&!o(t)&&(s=n(t,"options.format"));var s;i.isToday(e)&&(s="timeOnly");var a=i.timestamp2String(e,s,!0);return new Ember.Handlebars.SafeString(a)})}}),Ember.Application.initializer({name:"ArraysearchMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.set,r=i("arraysearch",{partials:{header:["search"]},init:function(){var e=n(this,"content.mixins");if(e){var t=n(this,"content.mixins").findBy("name","arraysearch");this.mixinOptions.arraysearch=t}this._super.apply(this,arguments)},computeFilterFragmentsList:function(){var e=this._super(),t=n(this,"findParams_searchFilterPart");return e.pushObject(t),e},actions:{searchItems:function(e){console.log("searchItems",e),o(this,"findOptions",e),void 0!==n(this,"currentPage")&&o(this,"currentPage",1),this.refreshContent()}},searchCriterionChanged:function(){console.log("searchFieldValueChanged: criterion",n(this,"searchCriterion"),"field value",n(this,"searchFieldValue"));var e=n(this,"searchFieldValue"),t={};if(null!==e&&void 0!==e){var i=this.computeFilterPartForCriterion(e);console.log("searchFilterPart",i),t=i}o(this,"findParams_searchFilterPart",t),this.refreshContent()}.observes("searchCriterion"),computeFilterPartForCriterion:function(e){console.log("search",n(this,"searchableAttributes"));var t=n(this,"searchableAttributes");if(void 0===t&&(console.warn("searchableAttributes not defined in controller, but searchItems still called. Trying to recompute searchableAttributes.",this),this.searchableAttributesUpdate(),t=n(this,"searchableAttributes"),console.log("new searchableAttributes",t),void 0===t))return void console.warn("searchableAttributes not defined in controller, but searchItems still called. Doing nothing.",this);if("object"!=typeof t)return void console.warn("searchableAttributes should be an array.",this);if(0===t.length)return void console.warn("Asking for a search on records with no searchableAttributes. Doing nothing.",this);for(var i=[],o=0,r=t.length;r>o;o++){var s={};s[t[o]]={$regex:e,$options:"i"},i.pushObject(s)}return JSON.stringify({$or:i})},searchableAttributesUpdate:function(){console.log("shown_columnsChanged");var e,t=n(this,"mixinOptions.arraysearch.searchable_columns");if(Ember.isNone(t)){var i=n(this,"shown_columns");e=Ember.A();for(var r=0,s=i.length;s>r;r++)e.push(i[r].field);
o(this,"searchableAttributes",e),console.log("new searchableAttributes",e)}else{e=Ember.A();for(var a=0,l=t.length;l>a;a++)e.push(t[a]);o(this,"searchableAttributes",e),console.log("new searchableAttributes computed from widget parameters",e)}}.observes("shown_columns")});t.register("mixin:arraysearch",r)}}),Ember.Application.initializer({name:"BackgroundMixin",after:["MixinFactory","FormsUtils","HashUtils"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.Mixin.create({didInsertElement:function(){var e=n(this,"controller.mixinOptions.background.imageUrl"),t=n(this,"controller.mixinOptions.background.position"),i=n(this,"controller.mixinOptions.background.repeat"),o=n(this,"controller.mixinOptions.background.size"),r=n(this,"controller.mixinOptions.background.backgroundcolor"),s=this.$();e&&s.css("background-image","url("+e+")"),t&&s.css("background-position",t),o&&s.css("background-size",o),i&&s.css("background-repeat",i),r&&s.css("background-color",r),this._super()}}),r=i("background",{init:function(){this._super(),this.addMixinView(o)}});t.register("mixin:background",r)}}),Ember.Application.initializer({name:"CrudMixin",after:["MixinFactory","FormsUtils","HashUtils","DataUtils"],initialize:function(e,t){function i(e,t,i){e.onRecordReady(t),console.log("temp record",t,o);var n=a(e,"mixinOptions.crud.formoptions"),s=a(e,"mixinOptions.crud.form");c(n)||$.extend(i,n),c(s)&&(s="modelform"),console.log("open form:",s,i);var d=o.showNew(s,t,i),u=e;d.submit.then(function(e){console.log("record going to be saved",t,e),"group"===a(t,"crecord_type")&&l(t,"id",r.generateId("group")),"profile"===a(t,"crecord_type")&&(console.error("set id for profile",t),l(t,"id",r.generateId("profile"))),t=a(e,"formContext"),t.save().then(function(){u.refreshContent()})})}var n=e.lookupFactory("factory:mixin"),o=e.lookupFactory("utility:forms"),r=e.lookupFactory("utility:hash"),s=e.lookupFactory("utility:data"),a=Ember.get,l=Ember.set,c=Ember.isNone,d=Ember.String.loc,u=n("crud",{partials:{selectionToolbarButtons:[],actionToolbarButtons:[],itemactionbuttons:[],header:[],subHeader:[],footer:[]},mixinsOptionsReady:function(){this._super(),a(this,"mixinOptions.crud.hideRemove")||(a(this,"partials.selectionToolbarButtons").pushObject("actionbutton-removeselection"),a(this,"partials.itemactionbuttons").pushObject("actionbutton-duplicate"),a(this,"partials.itemactionbuttons").pushObject("actionbutton-remove")),a(this,"mixinOptions.crud.hideEdit")||a(this,"partials.itemactionbuttons").pushObject("actionbutton-edit"),a(this,"mixinOptions.crud.hideCreate")||a(this,"partials.actionToolbarButtons").pushObject("actionbutton-create"),l(this,"itemsPerPagePropositionSelected",a(this,"itemsPerPage"))},userCanReadRecord:!0,userCanCreateRecord:!0,userCanUpdateRecord:!0,userCanDeleteRecord:!0,onRecordReady:function(e){this._super.apply(this,arguments)},actions:{add:function(e){this._super.apply(this,arguments),console.log("add",e);var t=a(this,"widgetDataStore").createRecord(e,{crecord_type:e}),n={title:"Add "+e};i(this,t,n)},duplicate:function(e){var t=s.getStore(),n=s.cleanJSONIds(e.serialize()),o=e.constructor.typeKey,r={};r[o]=n,t.pushPayload(o,r);var a=t.getById(o,n.id),l={title:"Duplicate "+o,inspectedItemType:o};i(this,a,l)},edit:function(e){console.log("edit",e);var t=a(this,"mixinOptions.crud.formoptions"),i=a(this,"mixinOptions.crud.form"),n={title:"Edit "+a(e,"crecord_type"),inspectedItemType:a(this,"listed_crecord_type")};c(t)||$.extend(n,t),c(i)&&(i="modelform"),console.log("open form:",i,n);var r=this,s=o.showNew(i,e,n);s.submit.then(function(t){console.log("record going to be saved",e,t),e=a(t,"formContext"),e.save(),r.trigger("refresh")})},remove:function(e,t){if(console.info("removing record",e),t)e.deleteRecord(),e.save();else{var i=o.showNew("confirmform",{},{title:d("Delete this record ?")});i.submit.then(function(t){e.deleteRecord(),e.save()})}},removeSelection:function(){var e=o.showNew("confirmform",{},{title:d("Delete these records ?")}),t=this;e.submit.then(function(e){var i=t.get("widgetData").filterBy("isSelected",!0);console.log("remove action",i);for(var n=0,o=i.length;o>n;n++){var r=i[n];t.send("remove",r,!0)}})}}});t.register("mixin:crud",u)}}),Ember.Application.initializer({name:"CustomfilterlistMixin",after:["FormsUtils","MixinFactory","DataUtils","NotificationUtils"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=e.lookupFactory("utility:forms"),o=e.lookupFactory("utility:data"),r=e.lookupFactory("utility:notification"),s=Ember.get,a=Ember.set,l=Ember.isNone,c=Ember.String.loc,d=i("customfilterlist",{partials:{subHeader:["customfilters"]},init:function(){this._super(),s(this,"model.user_filters")||a(this,"model.user_filters",Ember.A()),a(this,"multiFiltersTitle",[]),a(this,"customFilterOperators",[{value:"$and",display:"&",active:!0},{value:"$or",display:"||",active:!1}])},isSelectedFilter:function(e){if(!e||!e.length)return!1;if(!s(this,"mixinOptions.customfilterlist.can_mix_filters"))for(var t=e.length,i=s(this,"model.selected_filter.title"),n=0;t>n;n++){var o=s(e[n],"title");console.log("compare filters",i,o),i===o?a(e[n],"isActive",!0):a(e[n],"isActive",!1)}return e},filters_list:function(){return this.isSelectedFilter(s(this,"mixinOptions.customfilterlist.filters"))}.property("mixinOptions.customfilterlist.filters","model.selected_filter"),user_filters:function(){return this.isSelectedFilter(s(this,"model.user_filters"))}.property("model.user_filters","model.selected_filter"),computeFilterFragmentsList:function(){var e,t=this._super(),i=s(this,"model.mixins").findBy("name","customfilterlist"),n=s(this,"model.selected_filter.filter");return l(n)?s(this,"model.selected_filter")&&!n?e={}:i&&i.default_filter?(e=i.default_filter,e=JSON.parse(e)):e={}:e=n,t.pushObject(e),t},generateMultiFilter:function(){var e=s(this,"mixinOptions.customfilterlist.filters"),t=s(this,"model.user_filters"),i=[];i.addObjects(e),i.addObjects(t);var n,o,r=i.length,l=s(this,"multiFiltersTitle"),c={},d=s(this,"customFilterOperators"),u=d.length;for(n=0;u>n;n++)s(d[n],"active")&&(o=s(d[n],"value"));for(c[o]=[],n=0;r>n;n++){var p=s(i[n],"title");if(-1!==$.inArray(p,l)){var h=JSON.parse(s(i[n],"filter"));c[o].pushObject(h)}}0===c[o].length&&(c={});var m=JSON.stringify(c);a(this,"model.selected_filter",{filter:m})},actions:{setActiveOperator:function(e){for(var t=s(this,"customFilterOperators"),i=t.length,n=0;i>n;n++)a(t[n],"active",!1);a(e,"active",!0),this.generateMultiFilter(),this.refreshContent()},setFilter:function(e){var t=s(this,"mixinOptions.customfilterlist.can_mix_filters");if(t){console.log("multi filter mode");var i=s(this,"multiFiltersTitle"),n=s(e,"title"),o=!s(e,"isActive");a(e,"isActive",o),o?i.pushObject(n):i.removeObject(n),this.generateMultiFilter()}else{console.log("single filter mode");var r=s(e,"filter");a(this,"model.selected_filter",e),a(this,"model.userFilter",r),this.saveUserConfiguration(),l(s(this,"currentPage"))||a(this,"currentPage",1)}this.refreshContent()},addUserFilter:function(){var e=this,t=o.getStore().createRecord("customfilter",{crecord_type:"customfilter"}),i=n.showNew("modelform",t,{title:c("Create a custom filter for current list")});i.submit.then(function(i){t=i.get("formContext"),s(e,"model.user_filters").pushObject(t),e.notifyPropertyChange("model.user_filters"),console.log("Custom filter created",t,i),r.info(c("Custom filter created")),e.saveUserConfiguration()})},editFilter:function(e){var t=this,i=o.getStore().createRecord("customfilter",{crecord_type:"customfilter",filter:s(e,"filter"),title:s(e,"title")}),a=n.showNew("modelform",i,{title:c("Edit filter for current list")});a.submit.then(function(n){t.get("model.user_filters").removeObject(e),i=n.get("formContext"),t.get("model.user_filters").pushObject(i),console.log("Custom filter created",i,n),r.info(c("Custom filter created")),t.saveUserConfiguration()})},removeFilter:function(e){var t=s(e,"title"),i=n.showNew("confirmform",{},{title:c("Are you sure to delete filter")+" "+t+"?"}),o=this;i.submit.then(function(t){o.get("model.user_filters").removeObject(e),r.info(c("Custom filter removed")),o.saveUserConfiguration()})}}});t.register("mixin:customfilterlist",d)}}),Ember.Application.initializer({name:"DowntimeMixin",after:["MixinFactory","FormsUtils","HashUtils"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=e.lookupFactory("utility:forms"),o=Ember.get,r=Ember.set,s=Ember.isNone,a=i("Downtime",{partials:{selectionToolbarButtons:[],actionToolbarButtons:[],itemactionbuttons:[],header:[],subHeader:[],footer:[]},mixinsOptionsReady:function(){this._super(),o(this,"mixinOptions.downtime.hideRemove")||(o(this,"partials.selectionToolbarButtons").push("actionbutton-removeselection"),o(this,"partials.itemactionbuttons").push("actionbutton-remove")),o(this,"mixinOptions.downtime.hideEdit")||o(this,"partials.itemactionbuttons").push("actionbutton-edit"),o(this,"mixinOptions.downtime.hideCreate")||o(this,"partials.actionToolbarButtons").push("actionbutton-create"),r(this,"itemsPerPagePropositionSelected",o(this,"itemsPerPage"))},userCanReadRecord:function(){if("root"===o(this,"user"))return!0;var e=o(this,"listed_crecord_type");return o(this,"rights."+e+"_read.checksum")}.property("config.listed_crecord_type"),userCanCreateRecord:function(){if("root"===o(this,"user"))return!0;var e=o(this,"listed_crecord_type");return o(this,"rights."+e+"_create.checksum")}.property("config.listed_crecord_type"),userCanUpdateRecord:function(){if("root"===o(this,"user"))return!0;var e=o(this,"listed_crecord_type");return o(this,"rights."+e+"_update.checksum")}.property("config.listed_crecord_type"),userCanDeleteRecord:function(){if("root"===o(this,"user"))return!0;var e=o(this,"listed_crecord_type");return o(this,"rights."+e+"_delete.checksum")}.property("config.listed_crecord_type"),actions:{edit:function(e){console.log("edit",e);var t=o(this,"mixinOptions.downtime.formoptions"),i=o(this,"mixinOptions.downtime.form"),r={title:"Edit "+o(e,"crecord_type")};s(t)||$.extend(r,t),s(i)&&(i="modelform"),console.log("open form:",i,r);var a=this,l=n.showNew(i,e,r);l.submit.then(function(t){console.log("record going to be saved",e,t),e=o(t,"formContext"),e.save(),a.trigger("refresh")})}}});t.register("mixin:downtime",a)}}),Ember.Application.initializer({name:"DraggablecolumnsMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=i("draggablecolumns",{partials:{tableheader:["draggableheaders"]}});t.register("mixin:draggablecolumns",n)}}),Ember.Application.initializer({name:"EventConsumer",after:["MixinFactory"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=i("eventconsumer",{fetchEvents:function(e){var t=n(this,"widgetDataStore"),i=[],o={},r=this;e.forEach(function(e){var t=n(e,"rk"),r=n(e,"label");i.push(t),o[t]=r});var s=t.findQuery("event",{filter:JSON.stringify({_id:{$in:i}})});return s.then(function(e){r.onEvents(n(e,"content"),o)})},onEvents:function(e,t){}});t.register("mixin:eventconsumer",o)}}),Ember.Application.initializer({name:"GridlayoutMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=Ember.Mixin.create({didInsertElement:function(){var e,t=n(this,"controller.items.content"),i=!1,s=!1,a=n(this,"controller.mixins");r(a)||(e=a.findBy("name","gridlayout"),r(e)||(s=n(e,"forcelegacy")));var l=n(this,"controller.mixins").findBy("name","gridlayout"),c="12";r(n(l,"columnXS"))||(c=n(l,"columnXS"));var d="6";r(n(l,"columnMD"))||(d=n(l,"columnMD"));var u="3";r(n(l,"columnLG"))||(u=n(l,"columnLG"));var p=n(l,"offset")||"0",h=["col-md-",d," col-xs-",c," col-lg-",u," col-md-offset-",p].join("");n(l,"hiddenLG")&&(h+=" hidden-lg"),n(l,"hiddenMD")&&(h+=" hidden-md"),n(l,"hiddenXS")&&(h+=" hidden-xs hidden-sm"),o(this,"controller.defaultItemCssClass",h);for(var m=t.length-1;m>=0;m--){var f=n(t[m],"mixins");if(r(f)&&(o(t[m],"mixins",[]),f=n(t[m],"mixins")),r(f.findBy("name","gridlayout"))&&(r(e)&&(e={name:"gridlayout"}),f.pushObject(e),i=!0),s){var g=f.findBy("name","gridlayout");r(g)||f.removeObject(g),delete e.forcelegacy,f.pushObject(e),i=!0}h=n(this,"controller").getSection(f),Ember.setProperties(t[m],{classValue:h})}i&&n(this,"controller.viewController.content").save(),this._super()}}),a=i("gridlayout",{partials:{layout:["gridlayout"]},init:function(){this._super(),this.addMixinView(s)},isGridLayout:function(){return!0}.property(),getSection:function(e){var t=e.findBy("name","gridlayout"),i="12";r(t.columnXS)||(i=t.columnXS);var n="6";r(t.columnMD)||(n=t.columnMD);var s="3";r(t.columnLG)||(s=t.columnLG);var a=t.offset||"0",l=["col-md-",n," col-xs-",i," col-lg-",s," col-md-offset-",a].join("");return t.hiddenLG&&(l+=" hidden-lg"),t.hiddenMD&&(l+=" hidden-md"),t.hiddenXS&&(l+=" hidden-xs hidden-sm"),o(this,"defaultItemCssClass",l),l}});t.register("mixin:gridlayout",a)}}),Ember.Application.initializer({name:"HorizontallayoutMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=i("horizontallayout",{partials:{layout:["horizontallayout"]},section:function(){return n(this,"mixinOptions.horizontallayout.cellCssClass")||"col-lg-3 col-md-6 col-xs-12"}});t.register("mixin:horizontallayout",o)}}),Ember.Application.initializer({name:"LightlayoutMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=i("lightlayout",{partials:{layout:["lightlayout"]}});t.register("mixin:lightlayout",n)}}),Ember.Application.initializer({name:"ListlinedetailMixin",after:["MixinFactory","FormsRegistry","HashUtils"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=e.lookupFactory("utility:hash"),o=Ember.get,r=Ember.set,s=Ember.isNone,a=i("listlinedetail",{partials:{columnsLine:["actionbutton-foldable"],columnsHead:["column-unfold"]},actions:{unfold:function(e){var t=o(e,"unfolded");s(t)?r(e,"unfolded",!0):r(e,"unfolded",!t)}},init:function(){this._super.apply(this,arguments);var e=n.generateId("dynamic-listline-detail");r(this,"detailTemplate",e)},mixinsOptionsReady:function(){this._super.apply(this,arguments);var e=o(this,"detailTemplate"),t=o(this,"mixinOptions.listlinedetail.template");s(t)&&(t="No template defined"),r(Ember.TEMPLATES,e,Ember.Handlebars.compile(t))},colspan:function(){var e=o(this,"controller.shown_columns.length"),t=o(this,"controller._partials.columnsLine.length"),i=o(this,"controller._partials.itemactionbuttons");return s(e)&&(e=0),s(t)&&(t=0),s(i)&&(i=!1),i=!!i,e++,e+=t,i&&e++,e}.property("controller.shown_columns")});t.register("mixin:listlinedetail",a)}}),Ember.Application.initializer({name:"MetricConsumer",after:["MixinFactory","SerieController","PerfdataController"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=e.lookup("controller:serie"),o=e.lookup("controller:perfdata"),r=Ember.get,s=i("metricconsumer",{aggregateMetrics:function(e,t,i,n,s){var a=this;return new Ember.RSVP.Promise(function(l,c){var d=o.aggregateMany(e,t,i,n,s);d.then(function(e){r(e,"success")===!0?(a.onMetrics(r(e,"data")),l(e)):(console.error("Metric aggregation failed:",r(e,"data")),c(e))},function(){console.error("Metric aggregation request failed:",arguments),c(arguments)})})},fetchMetrics:function(e,t,i){var n=this;return new Ember.RSVP.Promise(function(s,a){var l=o.fetchMany(e,t,i);l.then(function(e){r(e,"success")===!0?(n.onMetrics(r(e,"data")),s(e)):(console.error("Metrics fetching failed:",r(e,"data")),a(e))},function(){console.error("Metric fetch request failed:",arguments),a(arguments)})})},onMetrics:function(e){},fetchSeries:function(e,t,i){var o=r(this,"widgetDataStore"),s=this,a={filter:JSON.stringify({crecord_name:{$in:e}})};new Ember.RSVP.Promise(function(l,c){o.findQuery("serie",a).then(function(o){if(r(o,"meta.success")!==!0)console.error("Series fetching failed:",r(o,"content")),c(o);else{var a=[];r(o,"content").forEach(function(e){a.push(n.fetch(e,t,i))}),Ember.RSVP.all(a).then(function(t){var i=[];t.forEach(function(t,n){i.push({label:e[n].replace(/ /g,"_"),points:t})}),s.onSeries(i),l(i)},function(){console.error("Series computation failed:",arguments),c(arguments)})}},function(){console.log("Series request failed:",arguments),c(arguments)})})},onSeries:function(e){}});t.register("mixin:metricconsumer",s)}}),Ember.Application.initializer({name:"MetricFilterable",after:["MixinFactory"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=i("metricfilterable",{getMetricFilter:function(){var e=n(this,"metric_filter"),t=e.split(" "),i={component:[],resource:[],name:[]};$.each(t,function(e,t){var n=t.slice(0,3),o={$regex:t.slice(3)};"co:"===n?i.component.push(o):"re:"===n?i.resource.push(o):"me:"===n?i.name.push(o):(o={$regex:t},i.component.push(o),i.resource.push(o),i.name.push(o))});var o={$and:[]};return $.each(i,function(e,t){if(t.length>0){var i={$or:[]};$.each(t,function(t,n){var o={};o[e]=n,i.$or.push(o)}),1===i.$or.length&&(i=i.$or[0]),o.$and.push(i)}}),0===o.$and.length?o={}:1===o.$and.length&&(o=o.$and[0]),o}});t.register("mixin:metricfilterable",o)}}),Ember.Application.initializer({name:"MinimizebuttonMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.set,o=i("minimizebutton",{init:function(){this._super(),n(this,"model.isMinimizable",!0)}});t.register("mixin:minimizebutton",o)}}),Ember.Application.initializer({name:"PaginationMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=i("pagination",{partials:{subHeader:["itemsperpage"],actionToolbarButtons:["pagination"],footer:["pagination-infos"],rightFooter:["pagination"]},init:function(){this._super()},mixinsOptionsReady:function(){this._super(),o(this,"itemsPerPagePropositionSelected",n(this,"itemsPerPage"))},isFirstPage:function(){return 1===n(this,"currentPage")&&1===n(this,"paginationFirstItemIndex")}.property("currentPage","paginationFirstItemIndex"),isLastPage:function(){return n(this,"currentPage")===n(this,"totalPages")}.property("currentPage","totalPages"),hasOnePage:function(){var e=1===n(this,"totalPages");return console.log("Is it a one page ?",e),e}.property("totalPages"),itemsPerPage:function(){var e=n(this,"model.itemsPerPage")||n(this,"mixinOptions.pagination.defaultItemsPerPage")||5;return e}.property("model.itemsPerPage","mixinOptions.pagination.defaultItemsPerPage"),paginationMixinContent:function(){console.warn("paginationMixinContent should be defined on the concrete class")},paginationMixinFindOptions:function(){console.warn("paginationMixinFindOptions should be defined on the concrete class")},actions:{prevPage:function(){n(this,"currentPage")>1&&o(this,"currentPage",n(this,"currentPage")-1)},nextPage:function(){n(this,"currentPage")<n(this,"totalPages")&&o(this,"currentPage",n(this,"currentPage")+1)},firstPage:function(){this.set("currentPage",1)},lastPage:function(){n(this,"currentPage")<n(this,"totalPages")&&o(this,"currentPage",n(this,"totalPages"))}},currentPage:1,itemsDivided:function(){return n(this,"itemsTotal")/n(this,"itemsPerPage")}.property("itemsTotal","itemsPerPage"),itemsPerPagePropositions:function(){var e=[5,10,20,50],t=n(this,"mixinOptions.pagination.customItemsPerPage");if(!r(t)&&Ember.isArray(t))for(var i=t.length,o=0;i>o;o++)isNaN(t[o])||e.push(parseInt(t[o]));var s=n(this,"itemsPerPage");return e.contains(s)||e.pushObject(s),e.sort(function(e,t){return e-t}),e}.property("itemsPerPagePropositionSelected"),onCurrentPageChanges:function(){this.refreshContent()}.observes("currentPage"),itemsPerPagePropositionSelectedChanged:function(){var e=n(this,"itemsPerPagePropositionSelected");n(this,"loaded")&&(Ember.setProperties(this,{"model.itemsPerPage":e,currentPage:1}),this.saveUserConfiguration()),this.refreshContent()}.observes("itemsPerPagePropositionSelected"),refreshContent:function(){console.group("paginationMixin refreshContent",n(this,"itemsPerPage")),void 0===n(this,"paginationMixinFindOptions")&&o(this,"paginationMixinFindOptions",{});var e=n(this,"itemsPerPage"),t=e*(this.currentPage-1);Ember.setProperties(this,{"paginationMixinFindOptions.start":t,paginationFirstItemIndex:t+1,"paginationMixinFindOptions.limit":e}),this._super.apply(this,arguments),console.groupEnd()},paginationLastItemIndex:function(){var e=n(this,"itemsPerPage"),t=e*(this.currentPage-1);return Math.min(t+e,n(this,"itemsTotal"))}.property("widgetData","itemsTotal"),paginationFirstItemIndex:function(){var e=n(this,"itemsPerPage"),t=e*(this.currentPage-1);return t+1}.property("widgetData"),itemsTotal:function(){return n(this,"widgetDataMetas").total}.property("widgetDataMetas","widgetData"),totalPages:function(){if(0===n(this,"itemsTotal"))return 0;var e=n(this,"itemsPerPage");return Math.ceil(n(this,"itemsTotal")/e)}.property("itemsTotal")});t.register("mixin:pagination",s)}}),Ember.Application.initializer({name:"PeriodicrefreshMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=Ember.Mixin.create({willInsertElement:function(){console.log("init periodicrefresh viewMixin"),this._super();var e=n(this,"controller"),t=n(this,"mixinOptions.periodicrefresh.refreshInterval");t&&clearInterval(t);var i=n(this,"widgetRefreshInterval"),r=this;Ember.run(function(){i=setInterval(function(){console.log("refreshing widget "+n(e,"title"),e.get("mixinOptions.periodicrefresh.refreshInterval"),e),Ember.run(function(){e.refreshContent()})},1e3*e.get("mixinOptions.periodicrefresh.refreshInterval")),o(r,"widgetRefreshInterval",i)})},willDestroyElement:function(){clearInterval(n(this,"widgetRefreshInterval")),this._super()}}),a=i("periodicrefresh",{init:function(){console.log("init periodicrefresh"),this.addMixinView(s);var e=n(this,"content.mixins");if(e){var t=n(this,"content.mixins").findBy("name","periodicrefresh");this.mixinOptions.periodicrefresh=t}this._super.apply(this,arguments),this.startRefresh(),(n(this,"mixinOptions.periodicrefresh.refreshInterval")<10||r(n(this,"mixinOptions.periodicrefresh.refreshInterval")))&&o(this,"mixinOptions.periodicrefresh.refreshInterval",10)}});t.register("mixin:periodicrefresh",a)}}),Ember.Application.initializer({name:"ResponsivelistMixin",after:["MixinFactory","FormsUtils","HashUtils"],initialize:function(e,t){function i(e){var t=a(e,"controller.mixinOptions.responsivelist.stackableColumnsPriority"),i=a(e,"controller"),n=a(i,"shown_columns"),o=Ember.A();if(console.log("stackableColumnsPriority",t,n),t)for(var r=0,s=t.length;s>r;r++){var l=n.findBy("field",t[r]);if(console.log("currentColumn",l),void 0!==l){console.log("currentColumn",l);var c=Ember.get(l,"index");console.log("columnIndex",c),o.pushObject(c)}}return console.log("stackableColumnsPriority@end",o),o}function n(e,t){console.log("hideColumn",t),c(t)||(this.$("th."+t.field).css("display","none"),this.$("td."+t.field).css("display","none"),a(e,"groupedColumns").pushObject(t),e.notifyPropertyChange("groupedColumns"))}function o(e,t,o,r){var s=r>o,l=a(e,"controller"),c=a(l,"shown_columns"),d=i(e);if(console.log("columnStackingPriority",d),s){console.group("table overflowing, starting shrink loop");for(var u=-1,p=r;s;)if(u++,console.log("while shownColumns[i]",u,c,c[u],d),void 0!==c[u]){if(void 0===d[u])return void console.log("no stacking priority, return",u,d);n(e,c[d[u]]),p-=c[u].width,s=p>o}console.groupEnd()}}function r(e){for(var t=a(e,"controller"),i=a(t,"shown_columns"),n=0,o=i.length;o>n;n++)l(i[n],"width",this.$("th."+i[n].field).width()),l(i[n],"index",n)}var s=e.lookupFactory("factory:mixin"),a=Ember.get,l=Ember.set,c=Ember.isNone,d=Ember.Mixin.create({classNames:["list"],groupedColumns:Ember.A(),invisibleCellsCount:function(){var e=a(this,"controller.shown_columns");return e.length-1}.property("controller.shown_columns"),didInsertElement:function(){this._super.apply(this,arguments);var e=this;a(e,"groupedColumns").clear();var t=r(e);console.log("resize call");var i=e.$(".table-responsive table").parent().width(),n=e.$(".table-responsive table").width();o(e,t,i,n)}}),u=s("responsivelist",{partials:{alternativeListDisplay:["groupedrowslistlayout"],subRowInformation:["stackedcolumns"]},stackedColumns:Ember.A(),groupedColumnsBindingActivator:0,init:function(){console.log("init responsivelist"),this.addMixinView(d);var e=a(this,"content.mixins");if(e){var t=a(this,"content.mixins").findBy("name","responsivelist");this.mixinOptions.responsivelist=t}this._super.apply(this,arguments)}});t.register("mixin:responsivelist",u)}}),Ember.Application.initializer({name:"ShowviewbuttonMixin",after:["MixinFactory","RoutesUtils","FormsUtils"],initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=e.lookupFactory("utility:routes"),o=e.lookupFactory("utility:forms"),r=Ember.isNone,s=Ember.String.loc,a=i("showviewbutton",{partials:{itemactionbuttons:["actionbutton-show"]},actions:{show:function(e){Ember.assert("There should be an id passed as first argument",!r(e)),console.log("Show action",arguments),n.getCurrentRouteController().send("showView",e)},viewrights:function(e){o.showNew("viewrightsform",e,{title:s("Edit view rights")})}}});t.register("mixin:showviewbutton",a)}}),Ember.Application.initializer({name:"SortablearrayMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.set,r=Ember.isNone,s=i("sortablearray",{init:function(){this._super(),o(this,"sort_direction","ASC");var e=n(this,"model.user_sortedAttribute");if(e){o(this,"sortedAttribute",e);var t="sorting_asc"===n(this,"sortedAttribute.headerClassName")?"ASC":"DESC";o(this,"sort_direction",t)}},actions:{sort:function(e){var t=n(this,"sort_direction"),i="ASC"===t?"DESC":"ASC";o(this,"sort_direction",i),void 0!==n(this,"model.user_sortedAttribute")&&o(this,"model.user_sortedAttribute.headerClassName","sorting"),console.log("attribute",e),o(e,"headerClassName","sorting_"+i.toLowerCase()),o(this,"sortedAttribute",e),o(this,"model.user_sortedAttribute",e),console.log("sortBy",arguments),void 0===this.findOptions&&(this.findOptions={}),this.findOptions.sort=JSON.stringify([{property:e.field,direction:i}]),this.saveUserConfiguration(),this.refreshContent()}},computeShownColumns:function(e){for(var t=this._super(e),i=n(this,"sortedAttribute"),o=n(this,"default_column_sort"),s=0,a=t.length;a>s;s++)if(!r(o)&&o.property===t[s].field&&!r(o.direction)&&(r(i)||i==={})){var l="ASC"===o.direction?"sorting_asc":"sorting_desc";t[s].headerClassName=l}return t},attributesKeys:function(){console.log("attributesKeys from sortableArray");var e=this._super.apply(this),t=n(this,"sortedAttribute");if(console.log("sortedAttribute",t),void 0!==t)for(var i=0,r=e.length;r>i;i++){var s=e[i],a=n(t,"field"),l=n(t,"headerClassName");n(s,"field")===a?o(s,"headerClassName",l):o(s,"headerClassName","sorting")}else{if(!e)return[];for(var c=0,d=e.length;d>c;c++)o(e[c],"headerClassName","sorting")}return e}.property("inspectedProperty","inspectedDataArray")});t.register("mixin:sortablearray",s)}}),Ember.Application.initializer({name:"TablayoutMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=Ember.get,o=Ember.set,r=i("tablayout",{init:function(){n(this,"items.content").length>=0&&!Ember.isEmpty(n(this,"items.content")[0])&&(console.log("init tabs",n(this,"items.content")[0].get("widget")),this.send("selectTab",n(this,"items.content")[0].get("widget")),o(n(this,"items.content")[0],"tabSelected",!0)),this._super.apply(this,arguments)},actions:{selectTab:function(e){console.info("select tab",e),n(this,"selectedItem")&&o(this,"selectedItem.tabSelected",!1),o(e,"tabSelected",!0),o(this,"selectedItem",e)}},partials:{layout:["tablayout"]}});t.register("mixin:tablayout",r)}}),Ember.Application.initializer({name:"VerticallayoutMixin",after:"MixinFactory",initialize:function(e,t){var i=e.lookupFactory("factory:mixin"),n=i("verticallayout",{partials:{layout:["verticallayout"]}});t.register("mixin:verticallayout",n)}}),Ember.Application.initializer({name:"ListWidget",after:["WidgetFactory","PaginationMixin","InspectableArrayMixin","UserconfigurationMixin","DraggablecolumnsMixin","RoutesUtils","FormsUtils","ListlineView"],initialize:function(e,t){var i=e.lookupFactory("factory:widget"),n=e.lookupFactory("mixin:pagination"),o=e.lookupFactory("mixin:inspectable-array"),r=e.lookupFactory("mixin:userconfiguration"),s=e.lookupFactory("view:listline"),a=Ember.get,l=Ember.set,c=Ember.isNone,d={mixins:[o,n,r]},u=i("list",{css:"table table-striped table-bordered table-hover dataTable sortable",needs:["login","application","recordinfopopup"],standardListDisplay:!0,dynamicTemplateName:"loading",listlineControllerClass:s,user:Ember.computed.alias("controllers.login.record._id"),rights:Ember.computed.alias("controllers.login.record.rights"),safeMode:Ember.computed.alias("controllers.application.frontendConfig.safe_mode"),init:function(){Ember.setProperties(this,{custom_filters:[],widgetData:[],findOptions:{},loaded:!1}),this._super.apply(this,arguments)},rollbackableChanged:function(){var e=this;a(this,"model.rollbackable")===!1&&Ember.run.scheduleOnce("afterRender",this,function(){e.refreshContent()})}.observes("model.rollbackable"),generateListlineTemplate:function(e){var t='<td>{{#if pendingOperation}}<i class="fa fa-cog fa-spin"></i>{{/if}}{{component-checkbox checked=isSelected class="toggle"}}</td>';if(a(this,"_partials.columnsLine")&&(t+="{{#each columns in controller._partials.columnsLine}}<td>{{partial columns}}</td>{{/each}}"),void 0!==e&&0!==e.length){for(var i=0,n=e.length;n>i;i++){var o=e[i];console.log("currentColumn",o),a(o,"options.show")&&(t+=o.renderer&&a(this,"model.useRenderers")?['<td class="',o.field,'">{{component-renderer rendererType="',o.renderer,'" value=this.',o.field,' record=this field="',o.field,'" shown_columns=controller.shown_columns}}</td>'].join(""):['<td class="',o.field,'">{{this.',o.field,"}}</td>"].join(""))}var r=a(this,"_partials.itemactionbuttons");if(r){console.log("itemactionbuttons",r),t+='<td style="padding-left:0; padding-right:0"><div class="btn-group" style="display:flex">';for(var s=0,l=r.length;l>s;s++)t+=['{{partial "',r[s],'"}}'].join("");t+="</div></td>"}return console.log("generatedListlineTemplate",t),t}},updateInterval:function(e){console.warn("Set widget list time interval",e),l(this,"timeIntervalFilter",e),this.refreshContent()},getTimeInterval:function(){var e=a(this,"timeIntervalFilter");return c(e)?{}:e},itemType:function(){var e=a(this,"listed_crecord_type");return console.info("listed_crecord_type",e),void 0!==e&&null!==e?a(this,"listed_crecord_type"):"event"}.property("listed_crecord_type"),isAllSelectedChanged:function(){a(this,"widgetData").content.setEach("isSelected",a(this,"isAllSelected"))}.observes("isAllSelected"),historyMixinFindOptions:Ember.computed.alias("findOptions.useLogCollection"),inspectedDataArray:Ember.computed.alias("widgetData"),paginationMixinFindOptions:Ember.computed.alias("findOptions"),widgetDataMetas:{},findItems:function(){var e=this,t=a(this,"controllers.application");t.addConcurrentLoading("list-data"),c(a(this,"widgetDataStore"))&&l(this,"widgetDataStore",DS.Store.create({container:a(this,"container")}));var i=a(this,"itemType"),n=this.computeFindParams();a(this,"widgetDataStore").findQuery(i,n).then(function(i){var n=a(e,"listed_crecord_type"),o=a(e,"widgetDataStore").metadataFor(n);console.log("crecordTypeMetadata",o),Ember.setProperties(e,{widgetDataMetas:o,loaded:!0}),e.extractItems.apply(e,[i]);for(var r=0,s=i.content.length;s>r;r++)i.content[r].set("pendingOperation",!1);t.removeConcurrentLoading("list-data")})["catch"](function(t){console.warn("Catching error",t);var i="There seems to be an error with listed data, or maybe selected record type is not in widget list schema.";console.error(i),a(this,"content.displayedErrors").pushObject(i),l(e,"dataError",t);
})},widgetDataChanged:function(){this.trigger("refresh")}.observes("widgetData"),attributesKeysDict:function(){for(var e={},t=a(this,"attributesKeys"),i=a(this,"sortedAttribute"),n=0,o=t.length;o>n;n++)void 0!==i&&i.field===t[n].field?(i.renderer=this.rendererFor(i),e[t[n].field]=i):(t[n].renderer=this.rendererFor(t[n]),e[t[n].field]=t[n]);return e}.property("attributesKeys"),rendererFor:function(e){var t=a(e,"type"),i=a(e,"options.role");a(e,"model.options.role")&&(i=a(e,"model.options.role"));var n=a(e,"options.items.role");"array"!==i||c(n)||(i=n);var o;return o=i?"renderer-"+i:"renderer-"+t,void 0===Ember.TEMPLATES[o]&&(o=void 0),o},shown_columns:function(){if(console.log("compute shown_columns",a(this,"sorted_columns"),a(this,"sortedAttribute")),void 0!==this.get("user_show_columns"))return console.log("user columns selected",a(this,"user_show_columns")),a(this,"user_show_columns");var e=[],t=a(this,"displayed_columns")||a(this,"model.displayed_columns");if(void 0!==t&&t.length>0)for(var i=this.get("attributesKeysDict"),n=0,o=t.length;o>n;n++)void 0!==i[t[n]]&&(l(i[t[n]].options,"show",!0),e.push(i[t[n]]));else console.log("no shown columns set, displaying everything"),e=this.get("attributesKeys");for(var r=[],s=a(this,"sortedAttribute"),d=a(this,"default_column_sort"),u=0,p=e.length;p>u;u++){if(e[u].options.canUseDisplayRecord&&delete e[u].options.canUseDisplayRecord,e[u].field===a(this,"display_record_field")&&(e[u].options.canUseDisplayRecord=!0),-1===$.inArray(e[u].field,a(this,"hidden_columns"))&&r.pushObject(e[u]),!c(d)&&d.property===e[u].field&&!c(d.direction)&&(c(s)||s==={})){var h="ASC"===d.direction?"sorting_asc":"sorting_desc";e[u].headerClassName=h}var m="no label",f=a(e[u],"options.label"),g=a(e[u],"options.title"),v=a(e[u],"field");g?m=g:f?m=f:v&&(m=v),l(e[u],"display_title",m)}console.debug("selected cols",r);var b=this.generateListlineTemplate(r);if(void 0!==b){var y=Ember.Handlebars.compile(b);l(this,"hbsListline",b);var E=a(this,"dynamicTemplateName");E&&delete Ember.TEMPLATES[E];var x="dynamic-list"+Math.floor(1e4*Math.random());Ember.TEMPLATES[x]=y,l(this,"dynamicTemplateName",x)}return r}.property("attributesKeysDict","sorted_columns"),computeFilterFragmentsList:function(){var e=Ember.A(),t=a(this,"model.volatile.forced_filter")||a(this,"additional_filter");return console.log("additionalFilterPart",a(this,"model.volatile.forced_filter"),a(this,"additional_filter")),e.pushObject(this.getTimeInterval()),e.pushObject(t),e},computeFindParams:function(){console.group("computeFindParams",a(this,"model.selected_filter.filter"));for(var e=this.computeFilterFragmentsList(),t=[],i=0,n=e.length;n>i;i++){if("string"==typeof e[i])try{e[i]=JSON.parse(e[i])}catch(o){void 0===a(this,"content.displayedErrors")&&l(this,"content.displayedErrors",Ember.A()),a(this,"content.displayedErrors").pushObject("There seems to be an error with the currently selected filter."),e[i]={}}e[i]==={}||c(e[i])||t.pushObject(e[i])}var r={};r.limit=a(this,"itemsPerPagePropositionSelected"),0===r.limit&&(r.limit=5),r.start=a(this,"paginationFirstItemIndex")-1,t.length&&(r.filter=JSON.stringify({$and:t}));var s=a(this,"model.user_sortedAttribute");if(c(s))c(a(this,"model.default_column_sort"))||(r.sort=JSON.stringify([a(this,"model.default_column_sort")]),console.log("defaultSortedAttribute",a(this,"model.default_column_sort")));else if(!c(s)){var d;d="sorting_asc"===a(s,"headerClassName")?"ASC":"DESC",r.sort=JSON.stringify([{property:s.field,direction:d}]),console.log("userSortedAttribute",s)}return console.groupEnd(),r}},d);t.register("widget:list",u)}}),Ember.Application.initializer({name:"TextWidget",after:["WidgetFactory","TimeWindowUtils","EventConsumer","MetricConsumer"],initialize:function(e,t){var i=e.lookupFactory("factory:widget"),n=e.lookupFactory("mixin:eventconsumer"),o=e.lookupFactory("mixin:metricconsumer"),r=e.lookupFactory("utility:timewindow"),s=window.Handlebars,a=Ember.String.loc,l=Ember.get,c=Ember.set,d=Ember.isNone,u={mixins:[n,o]},p=i("text",{findItems:function(){var e=r.getFromTo(l(this,"time_window"),l(this,"time_window_offset")),t=e[0],i=e[1],n=l(this,"from"),o=l(this,"to");d(n)||(t=n),d(o)||(i=o),c(this,"context",{event:{},serie:{},metric:{}}),c(this,"context.from",t),c(this,"context.to",i);var s=!1,a=l(this,"events");!d(a)&&a.length&&(this.fetchEvents(a),s=!0),a=l(this,"metrics"),!d(a)&&a.length&&(this.aggregateMetrics(a,t,i,"last",i-t),s=!0),a=l(this,"series"),!d(a)&&a.length&&(this.fetchSeries(a,t,i),s=!0),s===!1&&this.renderTemplate()},onEvents:function(e,t){var i=l(this,"context");$.each(e,function(e,n){var o=l(n,"id"),r=t[o];d(r)?console.warn("No label found for event, will not be rendered:",o):c(i,"event."+r,n)}),c(this,"context",i),this.renderTemplate()},onMetrics:function(e){var t=l(this,"context");$.each(e,function(e,i){var n=l(i,"meta.data_id").split("/"),o=l(i,"points"),r=o.length,s=a("No data available");r&&(s=o[r-1][1]);var u=void 0,p=void 0,h=void 0;6===n.length?(u=n[4],h=n[5]):(u=n[4],p=n[5],h=n[6]);var m="metric."+u;d(l(t,m))&&c(t,m,{}),d(p)||(m+="."+p,d(l(t,m))&&c(t,m,{})),c(t,m+"."+h,s)}),c(this,"context",t),this.renderTemplate()},onSeries:function(e){var t=l(this,"context");$.each(e,function(e,i){var n=l(i,"points"),o=l(i,"label"),r=a("No data available");n.length&&(r=n[n.length-1][1]),c(t,"serie."+o,r)}),c(this,"context",t),this.renderTemplate()},makeTemplate:function(){var e=void 0;try{e=s.compile(l(this,"html"))}catch(t){e=function(){return"<i>Impossible to render template:</i> "+t}}c(this,"template",e)},renderTemplate:function(){this.makeTemplate();var e=l(this,"template"),t=l(this,"context");c(this,"rendered",new Ember.Handlebars.SafeString(e(t)))}},u);t.register("widget:text",p)}}),Ember.Application.initializer({name:"TopologyAdapters",after:"ApplicationAdapter",initialize:function(e,t){var i=e.lookupFactory("adapter:application"),n=Ember.get,o=Ember.isNone,r=i.extend({graphType:"topology",buildURL:function(e,t,i){return"/"+this.graphType+"/"+e+"s"},createRecord:function(e,t,i){var n={};(o(t)||o(t.typeKey))&&console.error("Error while retrieving typeKey from type is it is none.");var r=e.serializerFor(t.typeKey);n=r.serializeIntoHash(n,t,i,"PUT",{includeId:!0});var s=this.buildURL("graphelt");return this.ajax(s,"PUT",{data:{elts:n}})},updateRecord:function(e,t,i){return this.createRecord(e,t,i)},deleteRecord:function(e,t,i){var o=this.buildURL("graphelt",null),r=n(i,"id"),s={data:{ids:r}};return this.ajax(o,"DELETE",s)},findQuery:function(e,t,i){var n=this.buildURL(t.typeKey,null);return this.ajax(n,"POST",{data:i})}});t.register("adapter:graphelt",r),t.register("adapter:graph",r),t.register("adapter:vertice",r),t.register("adapter:edge",r),t.register("adapter:toponode",r),t.register("adapter:topoedge",r),t.register("adapter:topo",r)}}),Ember.Application.initializer({name:"TopologyWidget",after:["WidgetFactory","FormsUtils","DataUtils","TopologyViewMixin"],initialize:function(e,t){var i=e.lookupFactory("factory:widget"),n=e.lookupFactory("utility:forms"),o=(e.lookupFactory("utility:data"),e.lookupFactory("mixin:topology-view")),r=Ember.get,s=(Ember.set,i("topology",{viewMixins:[o],graphModel:{graph:null,recordsById:{},selected:{}},graph_cls:"canopsis.topology.elements.Topology",defaultVerticeCls:"canopsis.topology.elements.TopoNode",defaultEdgeCls:"canopsis.topology.elements.TopoEdge",graphEltType:"topo",verticeEltType:"toponode",edgeEltType:"topoedge",init:function(){this._super.apply(this,arguments)},getEntitiesFromServer:function(e,t,i){if(e.length>0){var n=function(t,i){$.ajax({url:"/context/ids",type:"POST",data:{ids:JSON.stringify(e)}}).then(t,i)},o=new Ember.RSVP.Promise(n);o.then(t,i)}else t({total:0})},_addGraph:function(e){var t=this,i=this.graphModel.recordsById;this.graphModel.graph=e,i[e.get("id")]=e;var n=e.get("_delts"),o=function(e){var o=n[e];o.id=e;var r=t.widgetDataStore.createRecord(o.type,o);return i[e]=r,r.save()};records_to_save=Object.keys(n).map(o);var r=function(){t.trigger("refresh")};Ember.RSVP.all(records_to_save).then(r,console.error)},findItems:function(){var e=this,t=r(this,"model.graph_id");if(void 0!==t){null!==this.graphModel.graph&&this.graphModel.graph.get("id")!==t&&(this.graphModel.graph=null,this.graphModel.recordsById={},this.graphModel.selected={});var i={ids:t,add_elts:!0},n=function(i){var n=null;if(1===i.content.length){if(n=i.content[0],null!==e.graphModel.graph){var o=n.get("_delts"),r=e.graphModel.recordsById,s=e.graphModel.selected;Object.keys(r).forEach(function(e){e!==t&&void 0===o[e]&&(delete r[e],delete s[e])})}e._addGraph(n)}else console.error("Several graph obtained from a simple request: "+i.content)},o=function(i){var n=e.widgetDataStore.createRecord(e.graphEltType,{id:t}),o=function(){e._addGraph(n)};n.save().then(o)};this.widgetDataStore.find("graph",i).then(n,o)}},deleteRecords:function(e,t,i,n){Array.isArray(e)||(e=[e]);var o=this,r=this.graphModel.graph.get("id"),s=this.graphModel.recordsById,a=this.graphModel.selected,l=function(e){var t=null,i=e.get("id");return i===r?console.error("Impossible to delete the graph"):(delete s[i],delete a[i],t=e.destroyRecord()),t},c=e.map(l),d=function(){void 0!==t&&t.call(n,arguments),o.findItems()},u=function(e){console.error(e),void 0!==i&&i.call(n,arguments),o.trigger("refresh")};Ember.RSVP.all(c).then(d,u)},select:function(e){Array.isArray(e)||(e=[e]);var t=function(e){this.graphModel.selected[e.get("id")]=e};e.forEach(t,this),this.trigger("refresh")},unselect:function(e){Array.isArray(e)||(e=[e]);e.forEach(deleteRecords,this),this.trigger("refresh")},saveRecords:function(e,t,i,n){Array.isArray(e)||(e=[e]);var o=e.map(function(e){var t=e.get("info");return void 0===t.view&&(t.view={}),t.view[r(this,"model.graph_id")]=e.view,e.save()});Ember.RSVP.all(o).then(t,n)["catch"](i,n)},newRecord:function(e,t,i,n,o,r){void 0===e&&(e=this.verticeEltType);var s=this.widgetDataStore.createRecord(e,t),a=function(e){console.error(e),void 0!==o&&o.call(r,e)},l=function(e){var t=e.get("id"),i=this.graphModel.recordsById,o=this.graphModel.graph,s=i[t];if(void 0!==s)this.deleteRecords(s);else{var l=o.get("elts");l.push(t),o.set("elts",l);var c=function(){i[t]=e,void 0!==n&&n.call(r,e)},d=function(t){e.destroyRecord().then(a)};o.save().then(c,d)}};return i?this.editRecord(s,l,a,this):l.call(this,s),s},editRecord:function(e,t,i,o){var r=this;"string"==typeof e&&(e=this.graphModel.recordsById[e]);var s=e.get("_type");switch(s){case"edge":break;case"vertice":case"graph":var a=["ok","minor","major","critical"],l=function(e){var t=e.id||e,i=t.lastIndexOf("."),n=t.substring(i+1);return n},c=function(e,t,i,n){var o=e[i];if(void 0!==o){var r=l(o),s=r;if("change_state"===r){var c=o.params;void 0!==c&&(s=c.state,s=a[s])}t.set(n,s)}},d=function(e,t,i,n){var o=t.get(i);switch(e.params[n]={id:"canopsis.topology.rule.action.",params:{}},o){case"worst_state":case"best_state":e.params[n].id+=o;break;default:o=a.indexOf(o),e.params[n].id+="change_state",e.params[n].params.state=o}},u=e.get("info");if(void 0!==u){var p=u.entity;void 0!==p&&e.set("entity",p);var h=u.label;void 0!==h&&e.set("label",h);var m=u.task;if(void 0!==m){var f=m.id||m;if(void 0!==f){var g=l(m);if("condition"===g){var v=m.params;if(void 0!==v){var b=v.condition;if(void 0!==b){var y=l(b.id||b);e.set("operator",y);var E=b.params;if(void 0!==E){if("nok"===y)e.set("operator","nok");else{var x=E.state,w=E.f;"canopsis.topology.rule.condition.is_nok"===w?x="nok":void 0!==x&&(x=a[x],e.set("in_state",x))}var _=E.min_weight;void 0!==_&&e.set("min_weight",_),c(v,e,"statement","then_state"),c(v,e,"_else","else_state")}}}}else e.set("operator",g)}}}}var C=n.showNew("modelform",e,{inspectedItemType:e.get("type")}),k=function(){switch(s){case"edge":break;case"vertice":case"graph":var n=e.get("info"),l=null;void 0!==n?(l=n.task,"string"==typeof l?(n.task={id:l},l=n.task):void 0===l&&(n.task={},l=n.task)):(n={task:{}},l=n.task);var c=e.get("entity");void 0!==c&&(n.entity=c);var u=e.get("label");void 0!==u&&(n.label=u);var p=e.get("operator");switch(p){case"change_state":case"worst_state":case"best_state":l.id="canopsis.topology.rule.action."+p,l.params={};break;case"_all":case"at_least":case"nok":if(l.id="canopsis.task.condition.condition",l.params={},l.params.condition={id:"canopsis.topology.rule.condition."+p,params:{}},"_all"!==p){var h=e.get("min_weight");l.params.condition.params.min_weight=h}var m=e.get("in_state");"nok"===m?"nok"!==p&&(l.params.condition.params.f="canopsis.topology.rule.condition.is_nok",l.params.condition.params.state=null):l.params.condition.params.state=a.indexOf(m),d(l,e,"then_state","statement"),d(l,e,"else_state","_else")}e.set("info",n)}var f=function(e){var i=e[0];void 0!==t&&t.call(o,i),r.trigger("refresh")},g=function(e){console.error(e),void 0!==i&&i.call(o,e)};r.saveRecords(e,f,g,r)},A=function(){void 0!==i&&i.call(o,e)};C.submit.done(k).fail(A)}}));t.register("widget:topology",s)}}),Ember.Application.initializer({name:"TopologyViewMixin",initialize:function(e,t){var i=window.d3,n=Ember.get,o=Ember.set,r=Ember.Mixin.create({shapesById:{},nodes:[],links:[],nodeClass:"node",linkClass:"link",edgeClass:"edge",toolbox:null,_layout:{type:"force",force:null,tree:null,cluster:null,partition:null,pack:null,activated:!0,engine:null},panel:null,source:null,toolboxGap:50,duration:500,_unit:32,translate:[1,1],scale:1.5,_defaultLayout:{partition:{sort:function(e,t){var n=i.ascending(e.name,t.name);return n},children:function(e){return e.sources}},pack:{sort:function(e,t){var n=i.ascending(e.name,t.name);return n},children:function(e){return e.sources}},cluster:{separation:function(e,t){var i=(e.parent==t.parent?1:2)/e.depth;return i},nodeSize:null,sort:function(e,t){var n=i.ascending(e.name,t.name);return n},children:function(e){return e.sources}},tree:{separation:function(e,t){var i=(e.parent==t.parent?1:2)/e.depth;return i},nodeSize:null,sort:function(e,t){var n=i.ascending(e.name,t.name);return n},children:function(e){return e.sources}},force:{charge:-30,linkDistance:20,linkStrength:1,friction:.9,theta:.8,gravity:.1}},optionsCharge:function(){return{min:-256,max:256}}.property("optionsCharge"),linkStrengthCharge:function(){return{min:0,max:1,step:.05}}.property("linkStrengthCharge"),linkDistanceCharge:function(){return{min:0,max:150,step:10}}.property("linkDistanceCharge"),frictionCharge:function(){return{min:0,max:1,step:.05}}.property("frictionCharge"),thetaCharge:function(){return{min:0,max:1,step:.05}}.property("thetaCharge"),gravityCharge:function(){return{min:0,max:1,step:.05}}.property("gravityCharge"),filter:function(){return this._filter}.property("filter"),filterChanged:function(){this._filter=n(this,"filter")}.observes("filter"),autoLayout:function(){return this._layout.activated}.property("autoLayout"),autoLayoutChanged:function(){this._layout.activated=n(this,"autoLayout"),this._layout.activated?this._layout.engine.start():this._layout.engine.stop()}.observes("autoLayout"),charge:function(){var e=this._layout[this._layout.type].charge;return e}.property("charge"),chargeChanged:function(){var e=n(this,"charge");this._layout[this._layout.type].charge=e,this._layout.engine.charge(e),this.redraw()}.observes("charge"),linkDistance:function(){var e=this._layout[this._layout.type].linkDistance;return e}.property("linkDistance"),linkDistanceChanged:function(){var e=this.get("linkDistance");this._layout[this._layout.type].linkDistance=e,this._layout.engine.linkDistance(e),this.redraw()}.observes("linkDistance"),linkStrength:function(){var e=this._layout[this._layout.type].linkStrength;return e}.property("linkStrength"),linkStrengthChanged:function(){var e=this.get("linkStrength");this._layout[this._layout.type].linkStrength=e,this._layout.engine.linkStrength(e),this.redraw()}.observes("linkStrength"),friction:function(){var e=this._layout[this._layout.type].friction;return e}.property("friction"),frictionChanged:function(){var e=this.get("friction");this._layout[this._layout.type].friction=e,this._layout.engine.friction(e),this.redraw()}.observes("friction"),theta:function(){var e=this._layout[this._layout.type].theta;return e}.property("theta"),thetaChanged:function(){var e=this.get("theta");this._layout[this._layout.type].theta=e,this._layout.engine.theta(e),this.redraw()}.observes("theta"),gravity:function(){var e=this._layout[this._layout.type].gravity;return e}.property("gravity"),gravityChanged:function(){var e=this.get("gravity");this._layout[this._layout.type].gravity=e,this._layout.engine.gravity(e),this.redraw()}.observes("gravity"),showProperties:function(){return this._showProperties}.property("showProperties"),rerender:function(){this._super.apply(this,arguments),this.didInsertElement()},registerHooks:function(){return result=this._super.apply(this,arguments),n(this,"controller").on("redraw",this,this.redraw),result},unregisterHooks:function(){return result=this._super.apply(this,arguments),n(this,"controller").off("redraw",this,this.redraw),result},didInsertElement:function(){this._super.apply(this,arguments),null!==n(this,"controller").graphModel.graph&&this.updateModel()},updateModel:function(){var e=this,t=n(this,"controller").graphModel.recordsById,i={},o=function(e){var n=e.id,o=t[n].get("info");if(o){var r=o.entity;void 0!==r&&(void 0===i[r]?i[r]=[e]:i[r].push(e))}},r=this.shapesById,s={nodes:[],links:[]};Object.keys(r).forEach(function(e){if(void 0===t[e]){var i=r[e];"link"===i.type?s.links.push(i.index):s.nodes.push(i.index),delete r[e]}}),["nodes","links"].forEach(function(e){indexToDelete=s[e];var t=0;indexToDelete.forEach(function(i){this[e].splice(i-t++,1)},this)},this),Object.keys(t).forEach(function(e){var i=t[e],n=this.getNode(i);this.shapesById[e]=n,"edge"===i.get("_type")?this.weaveLinks(n):n._weight=1,o(n)},this),this.nodes.forEach(function(e,i){var n=e.id,o=t[n];if("edge"===o.get("_type")){var r=o.get("sources")[0],s=this.shapesById[r];void 0!==s&&(s._weight+=o.get("weight"))}e.index=i,e.entity=void 0},this),this.links.forEach(function(e){if("string"==typeof e.source&&(e.source=this.shapesById[e.source]),"string"==typeof e.target){var t=this.shapesById[e.target];e.parent=e.target=t}},this),n(this,"controller").getEntitiesFromServer(Object.keys(i),function(t){0!==t.total&&t.data.forEach(function(e){i[e._id].forEach(function(t){t.entity=e})}),e.trigger("redraw")})},redraw:function(){var e=this,t=n(this,"controller.model.width");t||(t=this.$().width());var o=n(this,"controller.model.height");o||(o=9*t/16);var r=n(this,"controller.model.layout"),s=this._layout;s.type=r;var a=s.engine;if(null===s[r]&&(a=s.engine=i.layout[r](),s[r]=this._defaultLayout[r]),a.size([t,o]),this.panel=i.select(this.$("svg .panel")[0]),0===this.panel.size()){var l=function(){if(!e.dragging){console.log(e.translate,i.event.translate);var t=[];[0,1].forEach(function(e){t[e]=i.event.translate[e]}),e.translate=t,e.scale=Math.max(i.event.scale,1.5);var n="translate("+t+")scale("+e.scale+")";e.panel.attr("transform",n)}},c=function(e,t){force.stop()},d=function(e,t){e.px+=i.event.dx,e.py+=i.event.dy,e.x+=i.event.dx,e.y+=i.event.dy,tick()},u=function(e,t){e.fixed=!0,tick(),s.activated&&force.resume()},l=(i.behavior.drag().on("dragstart",c).on("drag",d).on("dragend",u),i.behavior.zoom().scaleExtent([1.5,10]).on("zoom",l));this.panel=i.select(this.$("svg")[0]).attr({width:t,height:o}).append("g").classed({panel:!0}).attr({}).on("click",function(){return e.clickAction(this)}).on("mousemove",function(){return e.moveAction(this)}).on("mouseout",function(){return e.overAction(this)}).on("dblclick",function(){return e.addHandler()}).call(l)}var p="translate("+this.translate+")scale("+this.scale+")";this.panel.attr("transform",p);var h=this.panel.select(".overlay");0===h.size()&&this.panel.append("rect").classed("overlay",!0).attr("width",t).attr("height",o),e.overlay=h,a.nodes(this.nodes).links(this.links);var m=this.panel.selectAll("."+this.linkClass).data(this.links,function(e){return e.id}),f=m.enter();this.addLinks(f);var g=m;this.updateLinks(g);var v=m.exit();this.delLinks(v);var b=this.panel.selectAll("."+this.nodeClass).data(this.nodes,function(e){return e.id}),y=b.enter();this.addNodes(y);var E=b;this.updateNodes(E);var x=b.exit();this.delNodes(x),this.refreshSelectedShapes(),this.refreshLockedShapes(),a.on("tick",function(){s.activated||a.stop(),m.attr({d:function(e){return"M"+e.source.x+" "+e.source.y+"L"+e.target.x+" "+e.target.y}}),b.attr({transform:function(e){return"translate("+e.x+","+e.y+")"}})}),s.activated&&a.start()},weaveLinks:function(e){var t=n(this,"controller").graphModel.recordsById,i=e.id,o=t[i];o.get("sources"),o.get("targets");e._weight=o.get("weight"),e.sources={},e.targets={};var r={sources:{},targets:{}},s=[],a=function(t){var n="sources"===t,a=o.get(t);a.forEach(function(o){var s=r[t][o];void 0===s&&(s=0,r[t][o]=s),s++,r[t][o]=s;var a=e[t][o];void 0===a&&(a={},e[t][o]=a);var l=Object.keys(a).length;if(s>l){link={edge:e,type:"link",isSource:n,source:n?o:i,target:n?i:o,id:""+Math.random(),index:this.links.length},this.links.push(link),this.shapesById[link.id]=link;var c=this.shapesById[link.source];void 0!==c&&(link.source=c);var d=this.shapesById[link.target];void 0!==d&&(link.target=d),a[link.id]=link}},this);var l=function(i){var n=this.shapesById[i];delete e[t][c][i],delete this.shapesById[i],s.push(n.index)};for(var c in e[t]){var d=r[t][c],u=0;void 0!==d&&(u=d);var p=Object.keys(e[t][c]).splice(u);p.forEach(l,this)}};a.call(this,"sources"),a.call(this,"targets")},refreshSelectedShapes:function(){var e=n(this,"controller").graphModel.selected,t=this.panel.selectAll(".shapegroup").data(e,function(e){return e});t.classed("selected",!0),t.exit().classed("selected",!1)},refreshLockedShapes:function(){this.panel.selectAll(".shapegroup").filter(function(e){return e.fixed}).classed("locked",!0),this.panel.selectAll(".shapegroup").filter(function(e){return!e.fixed}).classed("locked",!1)},coordinates:function(){var e=[1,1];return null!==this.panel&&(e=i.mouse(this.panel[0][0])),e},showToolBox:function(e){if(!i.event.defaultPrevented){var t=e.__data__,n=this.getToolBoxItems(t),o=t?[t.x,t.y]:this.coordinates(),r=this;this.toolbox=this.panel.selectAll(".toolbox").data(n,function(e){return e.name});var s=this.toolbox.enter().append("g").style("opacity",0).attr({id:function(e){return"toolbox_"+e.name},"class":function(e){return"toolbox "+e.name},transform:function(e,t){var i=2*t*Math.PI/n.length,s=o[0]+Math.cos(i)*r.toolboxGap,a=o[1]+Math.sin(i)*r.toolboxGap,l="translate("+s+","+a+")",c="scale("+1/r.scale+")";return l+c+(e.transform?e.transform:"")}});s.append("path").attr({d:function(e,t){return e.symbol.size(20*r._unit)(e,t)}}).append("title").text(function(e){return e.name}),s.append("text").text(function(e){return e.name}),this.toolbox.on("click",function(i){r[i.name+"Handler"](t,e),r.destroyToolBox()}).transition().style("opacity",1).attr({transform:function(e,t){var i=2*t*Math.PI/n.length,s=o[0]+Math.cos(i)*r.toolboxGap,a=o[1]+Math.sin(i)*r.toolboxGap;return"translate("+s+","+a+") "+(e.transform?e.transform:"")}}),this.toolbox.exit().transition().duration(this.duration).style("opacity",0).remove()}},destroyToolBox:function(){this.toolbox&&this.toolbox.transition().duration(this.duration).style("opacity",0).remove()},closeHandler:function(e){i.event.stopPropagation()},editHandler:function(e){i.event.stopPropagation(),n(this,"controller").editRecord(e.id)},deleteHandler:function(e){i.event.stopPropagation(),Array.isArray(e)||(e=[e]);var t=[],o=n(this,"controller"),r=o.graphModel.recordsById;e.forEach(function(e){var i=r[e.id];if(void 0!==e.isSource){var n=e.isSource?"source":"target",o=i.get(n+"s"),s=o.indexOf(e[n]);o.splice(s,1),i.set(n+"s",o)}else t.push(i)}),t.length>0&&o.deleteRecords(t)},linkHandler:function(e,t){i.event.stopPropagation(),this.source=e},addHandler:function(e){i.event.stopPropagation();var t=n(this,"controller"),o=function(e){this.getNode(e),t.trigger("refresh")};if(null===this.source){t.newRecord(t.verticeEltType,void 0,!0,o,void 0,this)}else{var r=function(e){this.removeTmpLink(),t.trigger("refresh")},s=function(e){this.removeTmpLink()};this.addLink(this.source,e,!0,r,s,this)}},unselectHandler:function(e){i.event.stopPropagation(),n(this,"controller").unselect(e.id)},selectHandler:function(e){i.event.stopPropagation(),n(this,"controller").select(e.id)},unlockHandler:function(e){i.event.stopPropagation(),this.lock(e)},lockHandler:function(e){i.event.stopPropagation(),this.lock(e,!0)},cancelHandler:function(e){i.event.stopPropagation(),this.removeTmpLink()},eventpoolHandler:function(e){document.location.href="/eventpool/?"+e.elt.get("info").entity},removeTmpLink:function(){this.source=null,this.tmpLink&&this.tmpLink.remove(),this.tmpLink=null},lock:function(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){e.fixed=t}),this.refreshLockedShapes()},addNodes:function(e){var t=this,o=n(this,"controller").graphModel.recordsById,r=e.append("g").classed({shapegroup:!0,node:!0,edge:function(e){var t=o[e.id];return"edge"===t.get("_type")},graph:function(e){var t=o[e.id];return"graph"===t.get("_type")}}).attr({id:function(e){return e.id}}).on("click",function(){return t.clickAction(this)}).on("dblclick",function(){return t.dblClickAction(this)}).on("mouseover",function(){t.overAction(this)}).on("mouseout",function(){t.outAction(this)}).on("mousemove",function(){t.moveAction(this)});r.append("path").classed({shape:!0});var s=r.filter(function(e){var t=o[e.id];return"edge"!==t.get("_type")});s.append("title"),s.append("text").classed("entity",!0),s.append("text").classed("operator",!0);var a=r.filter(function(e){var t=o[e.id];return"edge"===t.get("_type")});a.append("text").classed("weight",!0);var l=this._layout.engine.drag.on("dragstart",function(e){i.event.sourceEvent.stopPropagation(),t.dragging=!0,t.panel.select(this).classed("dragging",!0)}).on("dragend",function(e){t.dragging=!1,t.panel.select(this).classed("dragging",!1)});r.call(l)},delNodes:function(e){e.transition().duration(this.duration).style("opacity",0).remove()},updateNodes:function(e){var t=this,o=n(this,"controller").graphModel.recordsById,r=n(this,"controller.model.graph_id");e.select("path").classed({ndok:function(e){var t=o[e.id];return!t.get("info").state||0==t.get("info").state},ndminor:function(e){var t=o[e.id];return 1==t.get("info").state},ndmajor:function(e){var t=o[e.id];return 2==t.get("info").state},ndcritical:function(e){var t=o[e.id];return 3==t.get("info").state}}).attr("d",function(e,n){var s=i.svg.symbol();void 0===e.x&&(e.x=0,e.y=0);var a=o[e.id];switch(a.get("_type")){case"graph":s=s.type("circle"),s=e.id===r?s.size(30*t._unit):s.size((e._weight>=1?e._weight:1)*t._unit);break;case"edge":s=s.type("diamond").size(e._weight*t._unit);break;case"vertice":s=s.type("square").size((e._weight>=1?e._weight:1)*t._unit);break;default:s=s.type("triangle-down")}var l=s(e,n);return l}),e.select("title").text(function(e){var t="",i=o[e.id],n=i.get("info");if(void 0!==n){var r=n.entity;void 0!==r&&(t+=r)}return t}),e.select(".entity").text(function(e){var t="",i=o[e.id],n=i.get("info");if(n&&n.label)t+=n.label;else{var r=e.entity;void 0!==r&&(t+=r.name)}return t}),e.select(".operator").text(function(e){var t="",i=o[e.id],n=i.get("info");if(void 0!==n){var r=n.task;if(r){var s=r.id||r;"canopsis.task.condition.condition"===s&&(r=r.params.condition,s=r.id||r),s=s.substring(s.lastIndexOf(".")+1),t+=s}"change_state"===t&&(t="")}return t}),e.select(".weight").text(function(e){var t="",i=o[e.id],n=i.get("weight");return void 0!==n&&1!==n&&(t+=n),t})},addLinks:function(e){var t=this;e.append("path").classed({shape:!0,link:!0,targetLink:function(e){return!e.isSource}}).attr({id:function(e){return e.id}}).on("click",function(){return t.clickAction(this)}).on("mouseout",function(){t.outAction(this)}).on("mousemove",function(){t.moveAction(this)}).on("mouseover",function(){t.overAction(this)})},delLinks:function(e){e.transition().duration(this.duration).style("opacity",0).remove()},updateLinks:function(e){var t=n(this,"controller").graphModel.recordsById;e.classed({directed:function(e){var i=t[e.edge.id];return i.get("directed")},lnok:function(e){var i=t[e.edge.id];return!i.get("info").state||0==i.get("info").state},lnminor:function(e){var i=t[e.edge.id];return 1==i.get("info").state},lnmajor:function(e){var i=t[e.edge.id];return 2==i.get("info").state},lncritical:function(e){var i=t[e.edge.id];return 3==i.get("info").state}}).style({"stroke-width":function(e){var i=1,n=t[e.edge.id],o=n.get("weight");return void 0!==o&&(i+=o-1),i},"marker-end":function(e){var i=t[e.edge.id];return i.get("directed")&&!e.isSource?"url(#markerArrow)":""}})},moveAction:function(e){i.event.defaultPrevented||this.overAction(e)},overAction:function(e){if(!i.event.defaultPrevented){var t=e.__data__;if(void 0!==t&&(d3Shape=i.select(e),d3Shape.classed("over",!0)),null!==this.source){console.log(t);t?[t.x,t.y]:this.coordinates()}}},checkTargetLink:function(e){var t=n(this,"controller").graphModel.recordsById,i=void 0===e;if(!i){var o=t[e.id||e];i="edge"!==o.get("_type")&&e.id!==this.source.id}return i},outAction:function(e){i.event.defaultPrevented||i.select(e).classed("over",!1)},dblClickAction:function(e){i.event.defaultPrevented||(i.event.stopPropagation(),n(this,"controller").editRecord(e.__data__.id),this.destroyToolBox())},clickAction:function(e){i.event.defaultPrevented||(i.event.stopPropagation(),this.showToolBox(e))},getNode:function(e){var t,i=e.get("id"),o=this.shapesById[i],r=n(this,"controller.model.graph_id"),s=e.get("info").view;return void 0!==s&&(t=s[r]),void 0===o&&(void 0===t?(o={fixed:!1,hidden:!1,id:i,index:this.nodes.length,type:e.get("type"),x:0,y:0,px:0,py:0},this.nodes.push(o)):o=t,this.shapesById[i]=o),o},addLink:function(e,t,i,o,r,s){var a=this,l=null,c=n(this,"controller"),d=c.graphModel.recordsById[e.id],u=d.get("_type"),p=n(c,"model.graph_id");if(e.id===p||!this.checkTargetLink(t))throw"Wrong parameters";var h=function(e){console.error(e),void 0!==r&&r.call(s,e)};if(void 0===t){var m=this.coordinates(),f=function(t){var n=this.getNode(t);n.px=n.x=m[0],n.py=n.y=m[1],this.addLink(e,n,i,o,r,s)};if(t=c.newRecord(c.verticeEltType,void 0,i,f,h,this),i)return}if("edge"===u){l=e,record=c.graphModel.recordsById[l.id];var g=record.get("targets");g.push(t.id),record.set("targets",g),record.save().then(function(){a.weaveLinks(l)},function(e){console.error(e)})}else{var v=function(e){var t=this.getNode(e);this.weaveLinks(t),void 0!==o&&o.call(s,e)};c.newRecord(c.edgeEltType,{sources:[e.id],targets:[t.id]},i,v,h,this)}return l},newToolBoxItem:function(e,t,n){var o={name:e,symbol:i.svg.symbol().type(t),transform:n,type:"toolbox"};return o},getToolBoxItems:function(e){var t=[],i=n(this,"controller.model.graph_id");if(null!==this.source)t.push(this.newToolBoxItem("close","triangle-down"),this.newToolBoxItem("cancel","cross","rotate(45)"),this.newToolBoxItem("add","cross"));else if(t.push(this.newToolBoxItem("close","triangle-down")),void 0!==e&&"link"!==e.type){var o=n(this,"controller").graphModel.recordsById[e.id],r=o.get("info");r&&r.entity&&t.push(this.newToolBoxItem("eventpool","triangle-up")),void 0!==n(this,"controller").graphModel.selected[e.id]?t.push(this.newToolBoxItem("unselect","diamond")):t.push(this.newToolBoxItem("select","diamond")),e.fixed?t.push(this.newToolBoxItem("unlock")):t.push(this.newToolBoxItem("lock")),e.id!==i&&t.push(this.newToolBoxItem("link","triangle-up"),this.newToolBoxItem("delete","cross","rotate(45)")),t.push(this.newToolBoxItem("edit","square"))}else t.push(this.newToolBoxItem("add","cross"));return t},actions:{showHideProperties:function(){var e=n(this,"showProperties");o(this,"showProperties",!e)},filter:function(){var e=n(this,"filter");this.filter(e),o(this,"filter",e)}}});t.register("mixin:topology-view",r)}}),Ember.Application.initializer({name:"UiactionbuttonWidget",after:"WidgetFactory",initialize:function(e,t){var i=e.lookupFactory("factory:widget"),n=i("uiactionbutton",{tagName:"span",
actions:{"do":function(e,t){(void 0===t||null===t)&&(t=[]),this.send(e,t)}}});t.register("widget:uiactionbutton",n)}}),Ember.Application.initializer({name:"UimaintabcollectionWidget",after:["WidgetFactory","WidgetController","FormsUtils","RoutesUtils"],initialize:function(e,t){var i=e.lookupFactory("controller:widget"),n=e.lookupFactory("utility:forms"),o=e.lookupFactory("utility:routes"),r=Ember.get,s=Ember.set,a=Ember.String.loc,l=i.extend({needs:["application","login"],currentViewId:Ember.computed.alias("controllers.application.currentViewId"),tagName:"span",userCanShowEditionMenu:!0,userCanEditView:!0,userCanCreateView:!0,isViewDisplayable:function(e){return!0},preparedTabs:function(){var e=this,t=Ember.A();return r(this,"tabs").forEach(function(i,n){i.value===r(e,"currentViewId")?s(i,"isActive",!0):s(i,"isActive",!1);var o=i.value||"";o=o.replace(".","_"),e.isViewDisplayable(o)?s(i,"displayable",!0):s(i,"displayable",!1),t.pushObject(i)}),t}.property("tabs","currentViewId"),actions:{"do":function(e,t){(void 0===t||null===t)&&(t=[]),this.send(e,t)},showViewOptions:function(){var e=o.getCurrentRouteController(),t=e.get("model"),i=n.showNew("viewtreeform",t,{title:a("Edit userview")});console.log("widgetWizard",i);var s=this;i.submit.done(function(){t.save().then(function(){r(s,"viewController").send("refresh")})})}}});t.register("widgetbase:uimaintabcollection",l)}}),Ember.Application.initializer({name:"ContainerWidget",after:["WidgetFactory","DebugUtils"],initialize:function(e,t){var i=e.lookupFactory("factory:widget"),n=e.lookupFactory("utility:debug"),o=Ember.get,r=Ember.Mixin.create({registerHooks:function(){return o(this,"controller").on("refreshChilds",this,this.refreshChilds),this._super()},unregisterHooks:function(){return o(this,"controller").off("refreshChilds",this,this.refreshChilds),this._super()},refreshChilds:function(){var e=this.$().children().find(".ember-view.widget"),t=this.$().attr("id");console.log("this id",t);for(var i=0,o=e.length;o>i;i++)if($(e[i]).parent().closest(".ember-view.widget").attr("id")===t){var r=n.getViewFromJqueryElement($(e[i])),s=r.get("controller");s.refreshContent()}}}),s=i("widgetcontainer",{init:function(){this.addMixinView(r),this._super()},refreshContent:function(){return console.log("container startRefresh"),this.trigger("refreshChilds"),this._super()},actions:{callAction:function(e,t){o(e,"controller")&&(e=o(e,"controller")),e.send(t)}}});t.register("widget:widgetcontainer",s)}});
//# sourceMappingURL=dist/brick.map.js